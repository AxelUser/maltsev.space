<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta
			name="viewport"
			content="width=device-width, initial-scale=1, maximum-scale=5, viewport-fit=cover"
		/>

		<!-- Favicons -->
		<link rel="icon" type="image/png" href="../favicon-96x96.png" sizes="96x96" />
		<link rel="icon" type="image/svg+xml" href="../favicon.svg" />
		<link rel="shortcut icon" href="../favicon.ico" />
		<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png" />
		<meta name="apple-mobile-web-app-title" content="Maltsev.Space" />
		<link rel="manifest" href="../site.webmanifest" />
		
		<link href="../_app/immutable/assets/one-column-layout.dk0RUYX7.css" rel="stylesheet">
		<link href="../_app/immutable/assets/tag-cloud.BFeWGeNI.css" rel="stylesheet">
		<link href="../_app/immutable/assets/0.Bz1Rqbdb.css" rel="stylesheet">
		<link href="../_app/immutable/assets/posts.BYtmJbQG.css" rel="stylesheet">
		<link href="../_app/immutable/assets/8.xEcK-EdQ.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/entry/start.Dn58_4L9.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/QI36R6sj.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/gL4yRitO.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Dkazavay.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CYgJF_JY.js">
		<link rel="modulepreload" href="../_app/immutable/entry/app.CA6WAvVr.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Dp1pzeXC.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/FC-Yzx7w.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Ix_iQA8O.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/0.COyJ86_V.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CgpvT9E8.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Cbg54n8Y.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DasYoi_Y.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/8.CGD7iKry.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CYcIynw4.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DTd9YT4P.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/D4zUk_qf.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DNSHY1Ls.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BhAgQEr3.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BBRK2HUr.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/1kdzElit.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BnxOsVrN.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/C0eIpL-d.js"><!--[--><link rel="alternate" type="application/rss+xml" title="Aleksey Maltsev's Blog" href="/rss.xml"> <link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml"><!--]--><!--[--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css" integrity="sha384-5TcZemv2l/9On385z///+d7MSYlvIEw9FuZTIdZ14vJLqWphw7e7ZPuOiCHJcFCP" crossorigin="anonymous"><!--]--><!--[--><meta name="description" content="Meet the data structure that refuses trade-offs: identical footprint to Bloom, fewer false positives, and deletion that works without overhead. Grab all three!"> <link rel="canonical" href="https://maltsev.space/blog/010-cuckoo-filters"> <!--[!--><meta name="robots" content="index, follow"><!--]--> <meta property="og:type" content="article"> <meta property="og:title" content="Cuckoo Filters: Better Than Bloom Filters? | MALTSEV.SPACE"> <meta property="og:description" content="Meet the data structure that refuses trade-offs: identical footprint to Bloom, fewer false positives, and deletion that works without overhead. Grab all three!"> <meta property="og:image" content="https://maltsev.space/images/og/010-cuckoo-filters.jpg"> <meta property="og:image:alt" content="Cuckoo Filters: Better Than Bloom Filters? - Cuckoo Filters: Better Than Bloom Filters?"> <meta property="og:url" content="https://maltsev.space/blog/010-cuckoo-filters"> <meta property="og:site_name" content="MALTSEV.SPACE"> <meta property="og:locale" content="en_US"> <!--[--><!--[--><meta property="article:published_time" content="2025-07-02T00:00:00.000Z"><!--]--> <!--[!--><!--]--> <!--[--><meta property="article:author" content="Aleksey Maltsev"><!--]--> <meta property="article:section" content="Technology"> <!--[--><meta property="article:tag" content="Cuckoo filters"><meta property="article:tag" content="Probabilistic data structures"><meta property="article:tag" content="Algorithms"><!--]--><!--]--> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:title" content="Cuckoo Filters: Better Than Bloom Filters? | MALTSEV.SPACE"> <meta name="twitter:description" content="Meet the data structure that refuses trade-offs: identical footprint to Bloom, fewer false positives, and deletion that works without overhead. Grab all three!"> <meta name="twitter:image" content="https://maltsev.space/images/og/010-cuckoo-filters.jpg"> <meta name="twitter:image:alt" content="Cuckoo Filters: Better Than Bloom Filters? - Cuckoo Filters: Better Than Bloom Filters?"> <meta name="twitter:site" content="@axel_user"> <meta name="twitter:creator" content="@axel_user">  <!----><script type="application/ld+json">{"@context":"https://schema.org","@type":"Person","name":"Aleksey Maltsev","jobTitle":"Senior Software Engineer","description":"Senior Software Engineer focused on distributed systems and highload applications","url":"https://maltsev.space/","image":"https://maltsev.space/images/ava.jpg","sameAs":["https://github.com/AxelUser","https://www.linkedin.com/in/dev-alexey-maltsev/"]}</script><!----> <!--[!--><!--]--> <!--[--><!----><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"Cuckoo Filters: Better Than Bloom Filters?","description":"Meet the data structure that refuses trade-offs: identical footprint to Bloom, fewer false positives, and deletion that works without overhead. Grab all three!","image":"https://maltsev.space/images/og/010-cuckoo-filters.jpg","author":{"@context":"https://schema.org","@type":"Person","name":"Aleksey Maltsev","jobTitle":"Senior Software Engineer","description":"Senior Software Engineer focused on distributed systems and highload applications","url":"https://maltsev.space/","image":"https://maltsev.space/images/ava.jpg","sameAs":["https://github.com/AxelUser","https://www.linkedin.com/in/dev-alexey-maltsev/"]},"publisher":{"@context":"https://schema.org","@type":"Person","name":"Aleksey Maltsev","jobTitle":"Senior Software Engineer","description":"Senior Software Engineer focused on distributed systems and highload applications","url":"https://maltsev.space/","image":"https://maltsev.space/images/ava.jpg","sameAs":["https://github.com/AxelUser","https://www.linkedin.com/in/dev-alexey-maltsev/"]},"url":"https://maltsev.space/blog/010-cuckoo-filters","datePublished":"2025-07-02T00:00:00.000Z","dateModified":"2025-07-02T00:00:00.000Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://maltsev.space/blog/010-cuckoo-filters"},"keywords":["Cuckoo filters","Probabilistic data structures","Algorithms"]}</script><!----><!--]--><!--]--><title>Cuckoo Filters: Better Than Bloom Filters? | MALTSEV.SPACE</title>
	</head>

	<body data-sveltekit-preload-data="hover">
		<div style="display: contents"><!--[--><!--[--><!----><div class="space-layout svelte-144yekp"><header class="svelte-1eq0cli"><div class="space-container nav-bar svelte-7gsxae"><div class="logo svelte-1eq0cli"><a href="/" class="svelte-1eq0cli">MALTSEV.SPACE</a></div> <ul class="nav-links svelte-1eq0cli"><li><a class="nav-link svelte-1eq0cli" href="/">Home</a></li> <li><a class="nav-link svelte-1eq0cli" href="/about">About</a></li> <li><a class="nav-link svelte-1eq0cli" href="/art">Gallery</a></li> <li><a class="nav-link svelte-1eq0cli" href="/blog">Blog</a></li></ul> <div class="nav-actions svelte-1eq0cli"><a href="/rss.xml" class="rss-link nav-link svelte-1eq0cli" aria-label="RSS Feed"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" class="lucide-icon lucide lucide-rss"><!--[--><!----><path d="M4 11a9 9 0 0 1 9 9"><!----></path><!----><!----><path d="M4 4a16 16 0 0 1 16 16"><!----></path><!----><!----><circle cx="5" cy="19" r="1"><!----></circle><!----><!--]--><!----><!----></svg><!----></a> <div class="theme-switch svelte-awph5w"><button class="theme-button svelte-awph5w" title="Light theme" aria-label="Light theme"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-sun"><!--[--><!----><circle cx="12" cy="12" r="4"><!----></circle><!----><!----><path d="M12 2v2"><!----></path><!----><!----><path d="M12 20v2"><!----></path><!----><!----><path d="m4.93 4.93 1.41 1.41"><!----></path><!----><!----><path d="m17.66 17.66 1.41 1.41"><!----></path><!----><!----><path d="M2 12h2"><!----></path><!----><!----><path d="M20 12h2"><!----></path><!----><!----><path d="m6.34 17.66-1.41 1.41"><!----></path><!----><!----><path d="m19.07 4.93-1.41 1.41"><!----></path><!----><!--]--><!----><!----></svg><!----></button> <button class="theme-button svelte-awph5w" title="Dark theme" aria-label="Dark theme"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-moon"><!--[--><!----><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"><!----></path><!----><!--]--><!----><!----></svg><!----></button> <button class="theme-button svelte-awph5w active" title="System theme" aria-label="System theme"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-laptop"><!--[--><!----><path d="M20 16V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v9m16 0H4m16 0 1.28 2.55a1 1 0 0 1-.9 1.45H3.62a1 1 0 0 1-.9-1.45L4 16"><!----></path><!----><!--]--><!----><!----></svg><!----></button></div><!----> <button class="mobile-menu-toggle svelte-1eq0cli" aria-label="Toggle menu"><!--[!--><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" class="lucide-icon lucide lucide-menu"><!--[--><!----><path d="M4 12h16"><!----></path><!----><!----><path d="M4 18h16"><!----></path><!----><!----><path d="M4 6h16"><!----></path><!----><!--]--><!----><!----></svg><!--]--></button></div><!----></div><!----> <div class="mobile-nav svelte-1eq0cli"><ul class="svelte-1eq0cli"><li class="svelte-1eq0cli"><a class="nav-link svelte-1eq0cli" href="/">Home</a></li> <li class="svelte-1eq0cli"><a class="nav-link svelte-1eq0cli" href="/about">About</a></li> <li class="svelte-1eq0cli"><a class="nav-link svelte-1eq0cli" href="/art">Gallery</a></li> <li class="svelte-1eq0cli"><a class="nav-link svelte-1eq0cli" href="/blog">Blog</a></li></ul></div></header><!----> <div class="stars-background svelte-17d2dmw"><!--[--><!--]--></div><!----> <main class="svelte-144yekp"><!--[!--><!----><!----> <div class="hero-background-container svelte-1hqqpnh"><!--[--><img src="data:image/png;base64,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" alt="Cuckoo Filters: Better Than Bloom Filters? hero image placeholder" class="hero-image hero-placeholder-image svelte-1hqqpnh"> <!--[!--><picture class="svelte-1hqqpnh"><!--[--><source srcset="/_app/immutable/assets/hero.B2uWPBry.avif 1x, /_app/immutable/assets/hero.CvZl82k-.avif 2x" sizes="min(1536px, 100vw)" type="image/avif" class="svelte-1hqqpnh"><source srcset="/_app/immutable/assets/hero.DeK7qp3N.webp 1x, /_app/immutable/assets/hero.DuXFaxUH.webp 2x" sizes="min(1536px, 100vw)" type="image/webp" class="svelte-1hqqpnh"><source srcset="/_app/immutable/assets/hero.BMxPsSDC.jpg 1x, /_app/immutable/assets/hero.DfuhpzPT.jpg 2x" sizes="min(1536px, 100vw)" type="image/jpeg" class="svelte-1hqqpnh"><!--]--> <img src="/_app/immutable/assets/hero.DfuhpzPT.jpg" alt="Cuckoo Filters: Better Than Bloom Filters? hero image" loading="lazy" class="hero-image hero-background-image svelte-1hqqpnh" width="1536" height="1024" onload="this.__e=event" onerror="this.__e=event"></picture><!--]--><!--]--> <div class="hero-content svelte-1hqqpnh"><hgroup class="svelte-1hqqpnh"><div class="post-meta svelte-1hqqpnh"><time datetime="2024-06-15" class="meta-item svelte-1hqqpnh">2025-07-02</time> <span class="meta-separator svelte-1hqqpnh">•</span> <span class="meta-item svelte-1hqqpnh">by Aleksey Maltsev</span> <!--[--><span class="meta-separator svelte-1hqqpnh">•</span> <span class="meta-item svelte-1hqqpnh">14 min</span><!--]--> <!--[--><span class="meta-separator svelte-1hqqpnh">•</span> <span class="meta-item svelte-1hqqpnh">1,650 views</span><!--]--></div> <h1 class="space-title svelte-1hqqpnh">Cuckoo Filters: Better Than Bloom Filters?</h1> <!--[--><p class="post-preview svelte-1hqqpnh">Meet the data structure that refuses trade-offs: identical footprint to Bloom, fewer false positives, and deletion that works without overhead. Grab all three!</p><!--]--></hgroup></div></div><!----> <div class="space-container undefined svelte-7gsxae"><article class="svelte-16vu21h"><div class="post-navigation top-navigation svelte-16vu21h"><!--[--><a href="/blog" class="button primary medium svelte-1edpa7d"><!---->← Back to all posts<!----></a><!--]--><!----></div> <!--[--><!--[--><div class="series-banner svelte-2z90k"><div class="series-title svelte-2z90k">More from this series</div> <ol class="series-list svelte-2z90k"><!--[--><li class="series-item svelte-2z90k"><a href="/blog/008-bloom-filters-pt1" class="series-link svelte-2z90k">Grokking Bloom Filters: The Classic Bloom Filter Demystified</a></li><li class="series-item svelte-2z90k"><a href="/blog/009-counting-bloom-filters" class="series-link svelte-2z90k">Grokking Bloom Filters: Counting Bloom Filter</a></li><li class="series-item svelte-2z90k"><a href="/blog/010-cuckoo-filters" class="series-link svelte-2z90k">Cuckoo Filters: Better Than Bloom Filters?</a></li><!--]--></ol></div><!--]--><!--]--> <div class="prose"><p>Bloom Filters are brilliant, they use minimal memory to support approximate membership query operations, i.e., answering what elements may be represented in a set, or what absolutely not. Their simplicity is both their strength and weakness. As I’ve described in a <a href="https://maltsev.space/blog/009-counting-bloom-filters" rel="nofollow">previous article about Counting Bloom Filter</a>, it’s not trivial to support deletion and preserve their guarantees of absence of false-negative results, i.e., telling what elements are not in a set.</p> <p>Counting Bloom Filters (CBF) and d-left Counting Bloom Filters are supposed to solve this issue, but they come at a cost of greater memory overhead, <strong>1.5</strong> to <strong>4</strong> times more than classic Bloom Filters do.</p> <p>In this article, I’ll describe a memory-efficient and deletion-friendly solution. Meet the Cuckoo Filters!</p> <h2 id="contents"><a class="header-anchor" aria-hidden="true" tabindex="-1" href="#contents">#</a>Contents</h2> <ul><li><a href="#what-are-cuckoo-filters">What are Cuckoo Filters?</a></li> <li><a href="#cuckoo-hashing-and-cuckoo-tables">Cuckoo Hashing and Cuckoo Tables</a></li> <li><a href="#fingerprints-and-partial-key-cuckoo-hashing">Fingerprints and Partial Key Cuckoo Hashing</a></li> <li><a href="#basic-operations">Basic Operations</a> <ul><li><a href="#lookup">Lookup</a></li> <li><a href="#insertion">Insertion</a></li> <li><a href="#deletion">Deletion</a></li></ul></li> <li><a href="#load-factor-in-cuckoo-filter">Load Factor in Cuckoo Filter</a></li> <li><a href="#what-are-the-benefits">What Are the Benefits?</a></li> <li><a href="#what-are-the-drawbacks">What Are the Drawbacks?</a> <ul><li><a href="#insertions-can-fail-when-the-table-is-too-full">Insertions can fail when the table is too full</a></li> <li><a href="#eviction-loops-at-high-load">Eviction loops at high load</a></li> <li><a href="#more-implementation-work">More implementation work</a></li> <li><a href="#table-size-must-be-a-power-of-two">Table size must be a power of two</a></li></ul></li> <li><a href="#fingerprint-size-and-error-rate">Fingerprint Size and Error Rate</a></li> <li><a href="#final-thoughts">Final Thoughts</a></li> <li><a href="#academic-researches">Academic Researches</a></li></ul> <h2 id="what-are-cuckoo-filters"><a class="header-anchor" aria-hidden="true" tabindex="-1" href="#what-are-cuckoo-filters">#</a>What are Cuckoo Filters?</h2> <p>Cuckoo Filters are a clever step forward in the world of probabilistic data structures. <a href="https://www.cs.cmu.edu/~dga/papers/cuckoo-conext2014.pdf" rel="nofollow">Introduced by Fan et al. in 2014</a>, they were designed to overcome some of the major limitations of <a href="https://maltsev.space/blog/008-bloom-filters-pt1" rel="nofollow">classic Bloom Filters</a>, especially around memory efficiency and the lack of support for deletions.</p> <p>What sets them apart is the internal structure. While Bloom Filters use a flat bit array, Cuckoo Filters adopt a more flexible <strong>hash-table</strong> layout with buckets and slots, and that subtle shift unlocks new capabilities. At first glance, they might remind you of the <a href="https://maltsev.space/blog/009-counting-bloom-filters#d-left-counting-bloom-filter" rel="nofollow">d-left Counting Bloom Filters</a> we discussed earlier, since both use a hash-table-like structure, but with quite impressive mechanics.</p> <div class="callout" data-callout="note" data-collapsible="false"><div class="callout-title"><div class="callout-title-icon" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="2" x2="22" y2="6"></line><path d="M7.5 20.5 19 9l-4-4L3.5 16.5 2 22z"></path></svg></div><div class="callout-title-text">Note</div></div><div class="callout-content"><p>If you’re unfamiliar with hash tables, here’s the short version: a hash table is a data structure that lets you store values and look them up efficiently using a key. Under the hood, it works like an array of <strong>buckets</strong>. A bucket can contain one or more key-value pairs in its <strong>slots</strong>. When you insert a key-value pair, the key is hashed — turned into a number — to figure out which bucket to use. A good hash function ensures that even similar keys produce very different hash values, which helps spread data evenly across buckets.</p></div></div> <p>To help visualize the difference, let’s compare their memory layouts:</p> <div class="scrollbox svelte-yiz1i3"><svg xmlns="http://www.w3.org/2000/svg" width="528" height="272" class="svgbob"><style>.svgbob line, .svgbob path, .svgbob circle, .svgbob rect, .svgbob polygon {
  stroke: black;
  stroke-width: 2;
  stroke-opacity: 1;
  fill-opacity: 1;
  stroke-linecap: round;
  stroke-linejoin: miter;
}

.svgbob text {
  white-space: pre;
  fill: black;
  font-family: Iosevka Fixed, monospace;
  font-size: 14px;
}

.svgbob rect.backdrop {
  stroke: none;
  fill: transparent;
}

.svgbob .broken {
  stroke-dasharray: 8;
}

.svgbob .filled {
  fill: black;
}

.svgbob .bg_filled {
  fill: transparent;
  stroke-width: 1;
}

.svgbob .nofill {
  fill: transparent;
}

.svgbob .end_marked_arrow {
  marker-end: url(#arrow);
}

.svgbob .start_marked_arrow {
  marker-start: url(#arrow);
}

.svgbob .end_marked_diamond {
  marker-end: url(#diamond);
}

.svgbob .start_marked_diamond {
  marker-start: url(#diamond);
}

.svgbob .end_marked_circle {
  marker-end: url(#circle);
}

.svgbob .start_marked_circle {
  marker-start: url(#circle);
}

.svgbob .end_marked_open_circle {
  marker-end: url(#open_circle);
}

.svgbob .start_marked_open_circle {
  marker-start: url(#open_circle);
}

.svgbob .end_marked_big_open_circle {
  marker-end: url(#big_open_circle);
}

.svgbob .start_marked_big_open_circle {
  marker-start: url(#big_open_circle);
}

</style><defs><marker id="arrow" viewBox="-2 -2 8 8" refX="4" refY="2" markerWidth="7" markerHeight="7" orient="auto-start-reverse"><polygon points="0,0 0,4 4,2 0,0"></polygon></marker><marker id="diamond" viewBox="-2 -2 8 8" refX="4" refY="2" markerWidth="7" markerHeight="7" orient="auto-start-reverse"><polygon points="0,2 2,0 4,2 2,4 0,2"></polygon></marker><marker id="circle" viewBox="0 0 8 8" refX="4" refY="4" markerWidth="7" markerHeight="7" orient="auto-start-reverse"><circle cx="4" cy="4" r="2" class="filled"></circle></marker><marker id="open_circle" viewBox="0 0 8 8" refX="4" refY="4" markerWidth="7" markerHeight="7" orient="auto-start-reverse"><circle cx="4" cy="4" r="2" class="bg_filled"></circle></marker><marker id="big_open_circle" viewBox="0 0 8 8" refX="4" refY="4" markerWidth="7" markerHeight="7" orient="auto-start-reverse"><circle cx="4" cy="4" r="3" class="bg_filled"></circle></marker></defs><rect class="backdrop" x="0" y="0" width="528" height="272"></rect><text x="178" y="12">Classic</text><text x="242" y="12">Bloom</text><text x="290" y="12">Filter</text><path d="M 184,32 A 16,16 0,0,0 184,48" class="nofill"></path><text x="186" y="44">each</text><text x="226" y="44">cell</text><line x1="264" y1="38" x2="272" y2="38" class="solid"></line><line x1="264" y1="42" x2="272" y2="42" class="solid"></line><text x="282" y="44">1</text><text x="298" y="44">bit</text><path d="M 320,32 A 16,16 0,0,1 320,48" class="nofill"></path><text x="34" y="76">1</text><text x="98" y="76">0</text><text x="162" y="76">1</text><text x="226" y="76">0</text><text x="290" y="76">1</text><text x="354" y="76">0</text><text x="418" y="76">1</text><text x="482" y="76">1</text><text x="34" y="108">0</text><text x="98" y="108">1</text><text x="162" y="108">2</text><text x="226" y="108">3</text><text x="290" y="108">4</text><text x="354" y="108">5</text><text x="418" y="108">6</text><text x="482" y="108">7</text><text x="194" y="140">Cuckoo</text><text x="250" y="140">Filter</text><path d="M 56,160 A 16,16 0,0,0 56,176" class="nofill"></path><text x="58" y="172">4</text><text x="74" y="172">buckets</text><text x="138" y="172">×2</text><text x="170" y="172">slots,</text><text x="226" y="172">each</text><text x="266" y="172">slot</text><line x1="304" y1="166" x2="312" y2="166" class="solid"></line><line x1="304" y1="170" x2="312" y2="170" class="solid"></line><text x="322" y="172">8</text><line x1="328" y1="168" x2="336" y2="168" class="solid"></line><text x="338" y="172">bit</text><text x="370" y="172">fingerprint</text><path d="M 456,160 A 16,16 0,0,1 456,176" class="nofill"></path><text x="18" y="204">[slot</text><text x="66" y="204">0]</text><text x="90" y="204">0xA7</text><text x="146" y="204">[slot</text><text x="194" y="204">0]</text><text x="218" y="204">0x1C</text><text x="274" y="204">[slot</text><text x="322" y="204">0]</text><text x="346" y="204">0xFF</text><text x="402" y="204">[slot</text><text x="450" y="204">0]</text><text x="474" y="204">null</text><text x="18" y="220">[slot</text><text x="66" y="220">1]</text><text x="90" y="220">0x2B</text><text x="146" y="220">[slot</text><text x="194" y="220">1]</text><text x="218" y="220">null</text><text x="274" y="220">[slot</text><text x="322" y="220">1]</text><text x="346" y="220">0x3D</text><text x="402" y="220">[slot</text><text x="450" y="220">1]</text><text x="474" y="220">0xA7</text><text x="34" y="252">Bucket</text><text x="90" y="252">0</text><text x="162" y="252">Bucket</text><text x="218" y="252">1</text><text x="290" y="252">Bucket</text><text x="346" y="252">2</text><text x="418" y="252">Bucket</text><text x="474" y="252">3</text><g><line x1="4" y1="56" x2="516" y2="56" class="solid"></line><line x1="4" y1="56" x2="4" y2="88" class="solid"></line><line x1="68" y1="56" x2="68" y2="88" class="solid"></line><line x1="132" y1="56" x2="132" y2="88" class="solid"></line><line x1="196" y1="56" x2="196" y2="88" class="solid"></line><line x1="260" y1="56" x2="260" y2="88" class="solid"></line><line x1="324" y1="56" x2="324" y2="88" class="solid"></line><line x1="388" y1="56" x2="388" y2="88" class="solid"></line><line x1="452" y1="56" x2="452" y2="88" class="solid"></line><line x1="516" y1="56" x2="516" y2="88" class="solid"></line><line x1="4" y1="88" x2="516" y2="88" class="solid"></line></g><g><line x1="4" y1="184" x2="516" y2="184" class="solid"></line><line x1="4" y1="184" x2="4" y2="232" class="solid"></line><line x1="132" y1="184" x2="132" y2="232" class="solid"></line><line x1="260" y1="184" x2="260" y2="232" class="solid"></line><line x1="388" y1="184" x2="388" y2="232" class="solid"></line><line x1="516" y1="184" x2="516" y2="232" class="solid"></line><line x1="4" y1="232" x2="516" y2="232" class="solid"></line></g></svg><!----></div><!----> <ul><li>In a Bloom Filter, every bit position is shared by multiple elements. Once a bit is set to <code>1</code>, there’s no way to know who set it.</li> <li>In a Cuckoo Filter, we store compact hashes of the original item, which are called <strong>fingerprints</strong>.</li></ul> <p>Let’s see how Cuckoo Filters work under the hood and the main concepts used in their design.</p> <h2 id="cuckoo-hashing-and-cuckoo-tables"><a class="header-anchor" aria-hidden="true" tabindex="-1" href="#cuckoo-hashing-and-cuckoo-tables">#</a>Cuckoo Hashing and Cuckoo Tables</h2> <p>The “Cuckoo” in <strong>Cuckoo Filter</strong> comes from a collision-handling technique called <strong>Cuckoo Hashing</strong>. It’s a clever and slightly mischievous way of dealing with a common problem in hash tables — what happens when two different elements want to land in the same bucket?</p> <p>Classic hash tables handle this with techniques like:</p> <ul><li><strong>Chaining</strong>: placing all colliding elements in a list inside the bucket, usually into a linked list.</li> <li><strong>Linear probing</strong>: scanning for the next available bucket if the first is fully occupied.</li></ul> <p>Cuckoo Hashing, however, takes a very different approach.</p> <p>In Cuckoo Hashing, each element has <strong>two possible buckets</strong> where it can be stored. Two different hash functions determine these.</p> <p>When inserting a new element:</p> <ol><li>You first try placing it in one of its two candidate buckets.</li> <li>If both are full, the algorithm <strong>evicts</strong> a randomly selected existing element from one of them.</li> <li>The evicted element is reinserted into its alternate bucket, possibly kicking out another element.</li> <li>This process repeats recursively until everyone finds a home, or the table expands if the chain doesn’t resolve.</li></ol> <p>This behavior is inspired by the cuckoo bird, which famously lays its eggs in other birds’ nests, displacing the existing ones — hence the name.</p> <!----><pre class="mermaid">graph TD
    A["New Element: 'orange'"] --> B["Calculate h1('orange') = Bucket 2<br/>Calculate h2('orange') = Bucket 5"]
    
    B --> C{"Check Bucket 2<br/>and Bucket 5"}
    C -->|"Both full"| D["Pick random bucket: Bucket 2<br/>Evict existing element: 'apple'"]
    C -->|"Space available"| E["Insert 'orange'<br/>✓ Success"]
    
    D --> F["Insert 'orange' into Bucket 2<br/>Now need to relocate 'apple'"]
    F --> G["Calculate alternate for 'apple'<br/>h2('apple') = Bucket 7"]
    
    G --> H{"Check Bucket 7"}
    H -->|"Space available"| I["Insert 'apple' into Bucket 7<br/>✓ Chain resolved"]
    H -->|"Full"| J["Evict element from Bucket 7<br/>Continue eviction chain..."]
    
    J --> K["Repeat process until:<br/>• Empty slot found<br/>• Max kicks reached<br/>• Cycle detected"]
    
    K --> L["Success: All elements placed"]
    K --> M["Failure: Table too full<br/>Need to resize"]
    
    style A fill:#5d5fef,color:#f8f9fa
    style E fill:#22d3ee,color:#212529
    style I fill:#22d3ee,color:#212529
    style L fill:#22d3ee,color:#212529
    style M fill:#dc2626,color:#f8f9fa
    style C fill:#f59e0b,color:#212529
    style H fill:#f59e0b,color:#212529</pre><!----> <p>Here’s how the bucket choices are calculated:</p> <!----><pre class="shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">const</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> h1</span><span style="color:#D73A49;--shiki-dark:#F97583"> =</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> hash1</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(key) </span><span style="color:#D73A49;--shiki-dark:#F97583">%</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> bucketCount; </span><span style="color:#6A737D;--shiki-dark:#6A737D">// Primary bucket</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">const</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> h2</span><span style="color:#D73A49;--shiki-dark:#F97583"> =</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> hash2</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(key) </span><span style="color:#D73A49;--shiki-dark:#F97583">%</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> bucketCount; </span><span style="color:#6A737D;--shiki-dark:#6A737D">// Alternate bucket</span></span></code></pre><!----> <p>Insertion picks either <code>h1</code> or <code>h2</code>, depending on which one has space. If both are full, one is chosen (often randomly), and the current occupant is kicked out and reinserted into its alternate bucket.</p> <p>This chain of evictions continues until a vacant slot is found — or until the process loops back on itself. In some rare cases, the eviction chain can become <strong>cyclic</strong>, meaning the same buckets get checked repeatedly with no progress. This indicates that the table is too full, and the only fix is to <strong>resize and rehash</strong> everything into a larger table.</p> <h2 id="fingerprints-and-partial-key-cuckoo-hashing"><a class="header-anchor" aria-hidden="true" tabindex="-1" href="#fingerprints-and-partial-key-cuckoo-hashing">#</a>Fingerprints and Partial Key Cuckoo Hashing</h2> <p>Hash tables work differently from Bloom Filters, Cuckoo Filters, and other approximate membership structures. <strong>They store the actual keys</strong>, which means they can answer lookups with zero false positives.</p> <p>But Cuckoo Filter aims to beat Bloom Filter at its own game—fast, compact membership checks with low memory use. Storing full keys would waste space and defeat that purpose. So what’s the alternative?</p> <p>In the article about <strong>Counting Bloom Filters</strong>, I mentioned a variant called the <strong>d-left Counting Bloom Filter</strong>. TL;DR: it’s a hash-table-like structure that doesn’t store full keys either. Instead, it stores <strong>fingerprints</strong> — small, fixed-size pieces of a hashed key, like 1 byte (8 bits). Fingerprints are compact and help keep the structure lightweight, so they are an excellent choice for the Cuckoo Filter.</p> <p>Now here’s the challenge: the classic Cuckoo Hashing algorithm relies on knowing the <strong>entire key</strong> when moving elements around. But in a Cuckoo Filter, we <strong>don’t store the key at all</strong>, only the fingerprint. That means the original eviction logic won’t work out of the box.</p> <p>To solve this, Fan et al. used a <a href="https://www.cs.cmu.edu/~dga/papers/silt-sosp2011.pdf" rel="nofollow">clever modification of Cuckoo Hashing</a>, called <strong>partial-key Cuckoo Hashing</strong>.</p> <div class="math math-display"><!----><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="normal">fp</mi><mo>⁡</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi mathvariant="normal">fingerprint</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>b</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>m</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>b</mi><mn>2</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">(</mo><msub><mi>b</mi><mn>1</mn></msub><mo>⊕</mo><mi>H</mi><mo stretchy="false">(</mo><mi mathvariant="normal">fp</mi><mo>⁡</mo><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>m</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\operatorname{fp} &amp;= \operatorname{fingerprint}(x) \\
b_1 &amp;= H(x) \bmod m \\
b_2 &amp;= \left( b_1 \oplus H(\operatorname{fp}) \right) \bmod m
\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.5em;vertical-align:-2em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mord mathrm">fp</span></span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop"><span class="mord mathrm">fingerprint</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">m</span></span></span><span style="top:-1.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mop"><span class="mord mathrm">fp</span></span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2em;"><span></span></span></span></span></span></span></span></span></span></span></span><!----></div> <p>Where:</p> <ul><li><span class="math math-inline"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span><!----></span> is the key</li> <li><span class="math math-inline"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span><!----></span> is a hash function</li> <li><span class="math math-inline"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span><!----></span> is the bucket count</li> <li><span class="math math-inline"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⊕</mo></mrow><annotation encoding="application/x-tex">\oplus</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">⊕</span></span></span></span><!----></span> denotes the XOR operation</li></ul> <p>The code usually is very straightforward:</p> <!----><pre class="shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">const</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> fp</span><span style="color:#D73A49;--shiki-dark:#F97583"> =</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> fingerprint</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(key)</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">const</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> b1</span><span style="color:#D73A49;--shiki-dark:#F97583"> =</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> hash</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(key) </span><span style="color:#D73A49;--shiki-dark:#F97583">%</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> bucketCount</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">const</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> b2</span><span style="color:#D73A49;--shiki-dark:#F97583"> =</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (b1 </span><span style="color:#D73A49;--shiki-dark:#F97583">^</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> hash</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(fp)) </span><span style="color:#D73A49;--shiki-dark:#F97583">%</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> bucketCount</span></span></code></pre><!----> <p>The core idea remains the same: each element still has two possible buckets, just like in regular Cuckoo Hashing. But instead of computing both directly from the key, the second bucket is derived from the first bucket and the fingerprint, using a simple bitwise <strong>XOR</strong> operation.</p> <div class="callout" data-callout="note" data-collapsible="false"><div class="callout-title"><div class="callout-title-icon" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="2" x2="22" y2="6"></line><path d="M7.5 20.5 19 9l-4-4L3.5 16.5 2 22z"></path></svg></div><div class="callout-title-text">Note</div></div><div class="callout-content"><p><strong>XOR</strong>, short for “exclusive OR”, is a simple binary operation: it compares two bits and returns <code>1</code> if they’re different, <code>0</code> if they’re the same. So:</p><ul><li><code>0 ^ 0 = 0</code></li> <li><code>1 ^ 0 = 1</code></li> <li><code>1 ^ 1 = 0</code></li></ul></div></div> <p>What makes XOR perfect for this use case is its <strong>reversible property</strong>:</p> <!----><pre class="shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">b1 </span><span style="color:#D73A49;--shiki-dark:#F97583">^</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> hash</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(fp) </span><span style="color:#D73A49;--shiki-dark:#F97583">==</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> b2</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">b2 </span><span style="color:#D73A49;--shiki-dark:#F97583">^</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> hash</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(fp) </span><span style="color:#D73A49;--shiki-dark:#F97583">==</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> b1</span></span></code></pre><!----> <p>That means if you know one bucket and the fingerprint, you can always calculate the other bucket, in either direction.
That’s what makes it awesome: the Cuckoo Filter doesn’t need to store or look up the original key at all. Everything it needs to manage insertions, lookups, and evictions is right there in the table.</p> <h2 id="basic-operations"><a class="header-anchor" aria-hidden="true" tabindex="-1" href="#basic-operations">#</a>Basic Operations</h2> <p>Now that we understand the internal structure of a Cuckoo Filter, let’s walk through how the main operations work — lookup, insertion, and deletion.</p> <h3 id="lookup"><a class="header-anchor" aria-hidden="true" tabindex="-1" href="#lookup">#</a>Lookup</h3> <p>To check if an element <em>might</em> be in the filter, you just need to check two buckets for the presence of the computed fingerprint:</p> <ol><li>Hash the element to get its <strong>fingerprint</strong>.</li> <li>Compute the <strong>first bucket</strong> from the element.</li> <li>Compute the <strong>second bucket</strong> using XOR with the fingerprint.</li> <li>Check both buckets. If either contains the fingerprint, return <code>true</code>.</li></ol> <p><strong>Time complexity:</strong> <code>O(1)</code> — just two hash calculations and two bucket scans.</p> <!----><pre class="shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">const</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> fp</span><span style="color:#D73A49;--shiki-dark:#F97583"> =</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> fingerprint</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">'apple'</span><span style="color:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">const</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> i1</span><span style="color:#D73A49;--shiki-dark:#F97583"> =</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> hash</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">'apple'</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) </span><span style="color:#D73A49;--shiki-dark:#F97583">%</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> bucketCount;</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">const</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> i2</span><span style="color:#D73A49;--shiki-dark:#F97583"> =</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (i1 </span><span style="color:#D73A49;--shiki-dark:#F97583">^</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> hash</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(fp)) </span><span style="color:#D73A49;--shiki-dark:#F97583">%</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> bucketCount;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">return</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> buckets[i1].</span><span style="color:#6F42C1;--shiki-dark:#B392F0">contains</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(fp) </span><span style="color:#D73A49;--shiki-dark:#F97583">||</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> buckets[i2].</span><span style="color:#6F42C1;--shiki-dark:#B392F0">contains</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(fp);</span></span></code></pre><!----> <div class="callout" data-callout="tip" data-collapsible="false"><div class="callout-title"><div class="callout-title-icon" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg></div><div class="callout-title-text">Tip</div></div><div class="callout-content"><p>Don’t forget that, just like a Bloom filter, this is a <strong>probabilistic check</strong>. You may get a false positive, but never a false negative.</p></div></div> <h3 id="insertion"><a class="header-anchor" aria-hidden="true" tabindex="-1" href="#insertion">#</a>Insertion</h3> <p>Insertion is trickier, as it involves chained eviction of conflicted elements to alternative buckets, which I’ve described above.</p> <p>To insert a new element:</p> <ol><li>Compute its <strong>fingerprint</strong>.</li> <li>Calculate its <strong>two candidate buckets</strong> (same as in lookup).</li> <li>Try placing the fingerprint into either bucket.</li> <li>If both are full, randomly pick one, <strong>evict</strong> an existing fingerprint, and try to reinsert the evicted one in its alternate bucket.</li> <li>Repeat for a fixed number of steps (e.g., 500). If all fail, report insertion failure or grow the table.</li></ol> <p><strong>Time complexity:</strong></p> <ul><li>Best case: <code>O(1)</code> (when fingerprint fits right away)</li> <li>Worst case: <code>O(k)</code> where <code>k = MAX_KICKS</code></li></ul> <!----><pre class="shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">const</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> fp</span><span style="color:#D73A49;--shiki-dark:#F97583"> =</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> fingerprint</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">'apple'</span><span style="color:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> i1 </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> hash</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">'apple'</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) </span><span style="color:#D73A49;--shiki-dark:#F97583">%</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> bucketCount;</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> i2 </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (i1 </span><span style="color:#D73A49;--shiki-dark:#F97583">^</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> hash</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(fp)) </span><span style="color:#D73A49;--shiki-dark:#F97583">%</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> bucketCount;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">if</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (buckets[i1].</span><span style="color:#6F42C1;--shiki-dark:#B392F0">insert</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(fp) </span><span style="color:#D73A49;--shiki-dark:#F97583">||</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> buckets[i2].</span><span style="color:#6F42C1;--shiki-dark:#B392F0">insert</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(fp)) </span><span style="color:#D73A49;--shiki-dark:#F97583">return</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="color:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">// Eviction loop</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> currentFp </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> fp;</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> i </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> Math.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">random</span><span style="color:#24292E;--shiki-dark:#E1E4E8">() </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> 0.5</span><span style="color:#D73A49;--shiki-dark:#F97583"> ?</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> i1 </span><span style="color:#D73A49;--shiki-dark:#F97583">:</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> i2;</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">for</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> n </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> 0</span><span style="color:#24292E;--shiki-dark:#E1E4E8">; n </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> MAX_KICKS</span><span style="color:#24292E;--shiki-dark:#E1E4E8">; n</span><span style="color:#D73A49;--shiki-dark:#F97583">++</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) &#123;</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    const</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> evictedFp</span><span style="color:#D73A49;--shiki-dark:#F97583"> =</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> buckets[i].</span><span style="color:#6F42C1;--shiki-dark:#B392F0">swapRandom</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(currentFp);</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    currentFp </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> evictedFp;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    i </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (i </span><span style="color:#D73A49;--shiki-dark:#F97583">^</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> hash</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(evictedFp)) </span><span style="color:#D73A49;--shiki-dark:#F97583">%</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> bucketCount;</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    if</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (buckets[i].</span><span style="color:#6F42C1;--shiki-dark:#B392F0">insert</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(evictedFp)) </span><span style="color:#D73A49;--shiki-dark:#F97583">return</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> true</span><span style="color:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">&#125;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">// Table is too full</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">return</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> false</span><span style="color:#24292E;--shiki-dark:#E1E4E8">;</span></span></code></pre><!----> <div class="callout" data-callout="warning" data-collapsible="false"><div class="callout-title"><div class="callout-title-icon" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg></div><div class="callout-title-text">Warning</div></div><div class="callout-content"><p>This is the main downside of Cuckoo Filters: <strong>insertions can fail</strong>. That usually means the table is too full, a common challenge with hash-based structures, which you can handle by resizing.</p></div></div> <h3 id="deletion"><a class="header-anchor" aria-hidden="true" tabindex="-1" href="#deletion">#</a>Deletion</h3> <p>Here’s where Cuckoo Filters shine compared to Bloom Filters — <strong>deletion doesn’t add more memory overhead and is safe</strong> (as long as the item was actually inserted):</p> <ol><li>Hash it to get its <strong>fingerprint</strong>.</li> <li>Compute its two possible buckets.</li> <li>If the fingerprint is found in either, remove it.</li></ol> <p><strong>Time complexity:</strong> <code>O(1)</code> —  same as for lookup, just two hash calculations and two bucket scans</p> <!----><pre class="shiki shiki-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">const</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> fp</span><span style="color:#D73A49;--shiki-dark:#F97583"> =</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> fingerprint</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">'apple'</span><span style="color:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">const</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> i1</span><span style="color:#D73A49;--shiki-dark:#F97583"> =</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> hash</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">'apple'</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) </span><span style="color:#D73A49;--shiki-dark:#F97583">%</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> bucketCount;</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">const</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> i2</span><span style="color:#D73A49;--shiki-dark:#F97583"> =</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (i1 </span><span style="color:#D73A49;--shiki-dark:#F97583">^</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> hash</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(fp)) </span><span style="color:#D73A49;--shiki-dark:#F97583">%</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> bucketCount;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">return</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> buckets[i1].</span><span style="color:#6F42C1;--shiki-dark:#B392F0">delete</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(fp) </span><span style="color:#D73A49;--shiki-dark:#F97583">||</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> buckets[i2].</span><span style="color:#6F42C1;--shiki-dark:#B392F0">delete</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(fp);</span></span></code></pre><!----> <div class="callout" data-callout="warning" data-collapsible="false"><div class="callout-title"><div class="callout-title-icon" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg></div><div class="callout-title-text">Warning</div></div><div class="callout-content"><p>While deletions are supported, deleting an element that was <strong>never inserted</strong> may still remove a matching fingerprint from another item, just like in Counting Bloom Filters.</p></div></div> <h2 id="load-factor-in-cuckoo-filter"><a class="header-anchor" aria-hidden="true" tabindex="-1" href="#load-factor-in-cuckoo-filter">#</a>Load Factor in Cuckoo Filter</h2> <p>In any open-addressing hash table, you keep an eye on a simple but important ratio:</p> <div class="math math-display"><!----><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>load factor </mtext><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo><mtext>  </mtext><mo>=</mo><mtext>  </mtext><mfrac><mrow><mtext>number of stored items </mtext><mtext> </mtext><mi>n</mi></mrow><mrow><mtext>number of available slots </mtext><mtext> </mtext><mi>m</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{load factor } (\alpha) \;=\; 
\frac{\text{number of stored items }\,n}
     {\text{number of available slots }\,m}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">load factor </span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">number of available slots </span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">number of stored items </span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><!----></div> <p>The <strong>load factor (α)</strong> is the fraction of storage slots that are already in use. It first appeared in ordinary hash tables, where you measure how many key/value pairs are sitting in the array of buckets. A low α means plenty of free space, so lookups and inserts are cheap. As α creeps toward 1.0, collisions pile up, probes get longer, and you eventually have to resize the table.</p> <p>Cuckoo Filters inherit the same idea, but each <em>bucket</em> holds several short fingerprints. You count <em>all</em> occupied fingerprint slots and divide by the total number of slots across every bucket:</p> <div class="math math-display"><!----><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>α</mi><mtext>CF</mtext></msub><mtext>  </mtext><mo>=</mo><mtext>  </mtext><mfrac><mtext>occupied slots</mtext><mrow><mtext>buckets</mtext><mo>×</mo><mtext>slots per bucket</mtext></mrow></mfrac></mrow><annotation encoding="application/x-tex">\alpha_{\text{CF}} \;=\;
\frac{\text{occupied slots}}{\text{buckets} \times \text{slots per bucket}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">CF</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2519em;vertical-align:-0.8804em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">buckets</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord">slots per bucket</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">occupied slots</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><!----></div> <p>With 4-slot buckets, you can usually push α as high as ≈0.95 before inserts start to fail.</p> <h2 id="what-are-the-benefits"><a class="header-anchor" aria-hidden="true" tabindex="-1" href="#what-are-the-benefits">#</a>What Are the Benefits?</h2> <p>Cuckoo Filters come with several practical advantages, especially when you’re aiming for <strong>low false positive rates</strong>.</p> <p>According to the original research by Fan et al., Cuckoo Filters outperform Bloom Filters in terms of space efficiency when the false positive rate is below <strong>3%</strong>. In other words, if you care about accuracy, they pack more data into less space.</p> <p>For example, this empirical analysis is provided by the authors <em>(all filters sized to 192 MiB)</em>:</p> <ul><li><strong>Cuckoo Filter</strong>: 12.60 bits per item, <strong>0.19%</strong> false positive rate</li> <li><strong>Bloom Filter</strong>: 13.00 bits per item, <strong>0.19%</strong> false positive rate</li> <li><strong>Cuckoo Filter with semi-sorting</strong>: 12.58 bits per item, <strong>0.09%</strong> false positive rate</li></ul> <p>So, not only do Cuckoo Filters match the false positive rate of Bloom Filters, but they often beat them by <strong>using less memory</strong>.</p> <div class="callout" data-callout="note" data-collapsible="false"><div class="callout-title"><div class="callout-title-icon" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="2" x2="22" y2="6"></line><path d="M7.5 20.5 19 9l-4-4L3.5 16.5 2 22z"></path></svg></div><div class="callout-title-text"><strong>Wait — what’s “semi-sorting”?</strong></div></div><div class="callout-content"><p>In the standard Cuckoo-Filter setup, a bucket holds <strong>4 fingerprints of 4 bits each</strong> — 16 bits total. But look-ups only check “does this fingerprint exist?”, so the <em>order</em> of those four values doesn’t matter.</p><p>The authors sorted each bucket’s fingerprints and listed every possible sorted pattern — just <strong>3876 unique combinations</strong>, far fewer than the 65536 raw bit-patterns. A bucket now stores a <strong>12-bit index</strong> into that pre-computed table instead of the full 16 bits.</p><p>Savings are *<strong>*roughly</strong>1 bit per element** with zero hit to query speed and only a tiny extra cost when inserting or deleting due to encoding/decoding gymnastics.</p></div></div> <p>One of the biggest wins is that Cuckoo Filters support <strong>native deletions:</strong> no workarounds, no tombstones or full rebuilds. To delete an element, you just locate its fingerprint in one of the two candidate buckets and remove it. Simple as that.</p> <p>This makes them a clean replacement for <strong>Counting Bloom Filters</strong>, which simulate deletion by using small counters, but at the cost of 3–4× more memory.</p> <p>Cuckoo Filters also offer <strong>predictable lookup performance</strong>, regardless of how full they get. Every query checks exactly <strong>2 buckets</strong>. With Bloom Filters, you need to access <strong>k</strong> random positions in the bit array, and <strong>k</strong> grows as you try to lower the false positive rate.</p> <p>Finally, in practice, Cuckoo Filters tend to have <strong>higher insertion and lookup throughput</strong> than Bloom Filters, especially when implemented with CPU cache behavior in mind. However, insertion will eventually degrade.</p> <h2 id="what-are-the-drawbacks"><a class="header-anchor" aria-hidden="true" tabindex="-1" href="#what-are-the-drawbacks">#</a>What Are the Drawbacks?</h2> <p>The previous section showed why Cuckoo Filters often beat Bloom Filters in terms of memory and accuracy. Those gains, however, are traded for extra complexity and stricter operating limits. Keep the following in mind before you drop Cuckoo Filters into production.</p> <h3 id="insertions-can-fail-when-the-table-is-too-full"><a class="header-anchor" aria-hidden="true" tabindex="-1" href="#insertions-can-fail-when-the-table-is-too-full">#</a>Insertions can fail when the table is too full</h3> <p>At roughly <strong>95 % load,</strong> an insertion may trigger hundreds of evictions (libraries usually cap this at ≈ 500). If no empty slot appears before the cap is reached, the operation returns “insert failed,” and the only remedy is to grow or rebuild the filter.</p> <h3 id="eviction-loops-at-high-load"><a class="header-anchor" aria-hidden="true" tabindex="-1" href="#eviction-loops-at-high-load">#</a>Eviction loops at high load</h3> <p>Near the same threshold, the eviction chain can bounce the identical fingerprints between two buckets <strong>FOREVER</strong>. Implementations abort after the kick limit, but the outcome remains an insertion failure.</p> <h3 id="more-implementation-work"><a class="header-anchor" aria-hidden="true" tabindex="-1" href="#more-implementation-work">#</a>More implementation work</h3> <ul><li>Partial-key Cuckoo hashing (two candidate buckets per fingerprint)</li> <li>Eviction logic with a bounded kick count</li> <li>Load-factor monitoring and timely resizing</li> <li>Bucket-width tuning (four fingerprints per bucket is a common sweet spot)</li></ul> <h3 id="table-size-must-be-a-power-of-two"><a class="header-anchor" aria-hidden="true" tabindex="-1" href="#table-size-must-be-a-power-of-two">#</a>Table size must be a power of two</h3> <p>The second bucket index is computed with a bitwise XOR trick:</p> <div class="math math-display"><!----><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>i</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>m</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>i</mi><mn>2</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">(</mo><msub><mi>i</mi><mn>1</mn></msub><mo>⊕</mo><mi>H</mi><mtext> ⁣</mtext><mrow><mo fence="true">(</mo><mi mathvariant="normal">fp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>m</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
i_1 &amp;= H(x) \bmod m \\
i_2 &amp;= \left( i_1 \oplus H\!\left(\operatorname{fp}(x)\right) \right) \bmod m
\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">m</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:-0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mop"><span class="mord mathrm">fp</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span></span></span></span></span><!----></div> <p>The paper <a href="https://people.bu.edu/staro/cuckoo_filter_workshop_paper.pdf" rel="nofollow"><em>Birdwatching: False Negatives in Cuckoo Filters</em></a> shows that this rule is <strong>provably safe only when the bucket count m equals 2ᵏ</strong>. If m is not a power of two, the final <code>mod m</code> strips high-order bits from the XOR result, breaking the reversible link between <code>i1</code> and <code>i2</code>. During long eviction chains, a fingerprint can slide into a third, illegal bucket and later disappear from both legal locations, so we can get a false negative result. The authors measured up to a <strong>10 % false-negative rate at 95 % load</strong> in such filters.</p> <p>Let’s see it in action. First, I’ll go through a good example when <code>m</code> is 16 (a power of two):</p> <div class="scrollbox svelte-yiz1i3"><table><thead><tr><th>Step</th><th>Expression</th><th>Decimal</th><th>Binary</th><th>Comment</th></tr></thead><tbody><tr><td>1</td><td><code>i1 = hash("apple") % 16</code></td><td>6</td><td>0110</td><td>First bucket</td></tr><tr><td>2</td><td><code>f  = hash(fp("apple"))</code></td><td>9</td><td>1001</td><td>Fingerprint hash</td></tr><tr><td>3</td><td><code>xor1 = i1 ^ f</code></td><td>15</td><td>1111</td><td>XOR before modulo</td></tr><tr><td>4</td><td><code>i2 = xor1 % 16</code></td><td>15</td><td>1111</td><td>Second bucket used at insert</td></tr><tr><td>5</td><td><code>xor2 = i2 ^ f</code></td><td>6</td><td>0110</td><td>Recompute <em>i1</em> before modulo</td></tr><tr><td>6</td><td><code>i1' = xor2 % 16</code></td><td>6</td><td>0110</td><td>Returns to the original bucket, great success</td></tr></tbody></table><!----></div><!----> <p>Now let’s see a bad example when <code>m</code> is 12 (not a power of two):</p> <div class="scrollbox svelte-yiz1i3"><table><thead><tr><th>Step</th><th>Expression</th><th>Decimal</th><th>Binary</th><th>Comment</th></tr></thead><tbody><tr><td>1</td><td><code>i1 = hash("apple") % m</code></td><td>6</td><td>0110</td><td>First bucket</td></tr><tr><td>2</td><td><code>f = hash(fp("apple"))</code></td><td>9</td><td>1001</td><td>Fingerprint hash</td></tr><tr><td>3</td><td><code>xor1 = i1 ^ f</code></td><td>15</td><td>1111</td><td>XOR before modulo</td></tr><tr><td>4</td><td><code>i2 = xor1 % 12</code></td><td>3</td><td>0011</td><td>The second bucket used at insert</td></tr><tr><td>5</td><td><code>xor2 = i2 ^ f</code></td><td>10</td><td>1010</td><td>Recompute i1 before modulo</td></tr><tr><td>6</td><td><code>i1' = xor2 % 12</code></td><td><strong>10</strong></td><td>1010</td><td>Should return to 6, but does not</td></tr></tbody></table><!----></div><!----> <h2 id="fingerprint-size-and-error-rate"><a class="header-anchor" aria-hidden="true" tabindex="-1" href="#fingerprint-size-and-error-rate">#</a>Fingerprint Size and Error Rate</h2> <p>Unlike a Bloom filter, a Cuckoo Filter’s fingerprint length is chosen almost solely from the error budget you can tolerate; the total number of stored elements hardly matters.</p> <p>During a negative lookup, we compare the query fingerprint with the at most <code>2b</code> fingerprints that live in the two candidate buckets (<code>b</code> slots each).</p> <p>Each comparison matches by pure chance with probability <span class="math math-inline"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mo>−</mo><mi>f</mi></mrow></msup></mrow><annotation encoding="application/x-tex">2^{-f}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span></span></span></span></span></span></span></span><!----></span>, so after <code>2b</code> comparisons, as derived by Fan et al., the <strong>upper bound</strong> on the false-positive probability ε is</p> <div class="math math-display"><!----><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mi>ϵ</mi><mo>≤</mo><mn>1</mn><mo>−</mo><msup><mrow><mo fence="true">(</mo><mn>1</mn><mo>−</mo><msup><mn>2</mn><mrow><mo>−</mo><mi>f</mi></mrow></msup><mo fence="true">)</mo></mrow><mrow><mn>2</mn><mi>b</mi></mrow></msup><mtext>  </mtext><mo>≈</mo><mtext>  </mtext><mfrac><mrow><mn>2</mn><mi>b</mi></mrow><msup><mn>2</mn><mi>f</mi></msup></mfrac></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(1)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">\epsilon \le 1 - \left(1 - 2^{-f}\right)^{2b} \;\approx\; \frac{2b}{2^{f}} \tag{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.4881em;vertical-align:-0.35em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.1381em;"><span style="top:-3.352em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">b</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7751em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathnormal">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="tag"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">1</span></span><span class="mord">)</span></span></span></span></span></span><!----></div> <p>Where:</p> <ul><li><strong><code>f</code></strong> is a fingerprint size in bits</li> <li><strong><code>ε</code></strong> is the desired false positive rate</li> <li><strong><code>b</code></strong> is bucket size (typically 4)</li></ul> <p>Rearranging (1) gives the <strong>fingerprint size lower bound</strong></p> <div class="math math-display"><!----><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mi>ε</mi><mo>≤</mo><mfrac><mrow><mn>2</mn><mi>b</mi></mrow><msup><mn>2</mn><mi>f</mi></msup></mfrac><mtext>  </mtext><mtext>  </mtext><mo>⟹</mo><mtext>  </mtext><mtext>  </mtext><mi>f</mi><mo>≥</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mtext> ⁣</mtext><mfrac><mrow><mn>2</mn><mi>b</mi></mrow><mi>ε</mi></mfrac><mtext>  </mtext><mo>=</mo><mtext>  </mtext><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mtext> ⁣</mtext><mfrac><mn>1</mn><mi>ε</mi></mfrac><mo>+</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mo stretchy="false">(</mo><mn>2</mn><mi>b</mi><mo stretchy="false">)</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(2)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">\varepsilon \le \frac{2b}{2^{f}}\;\;\Longrightarrow\;\;f \ge \log_{2}\!\frac{2b}{\varepsilon} \;=\; \log_{2}\!\frac{1}{\varepsilon} + \log_{2}(2b) \tag{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">ε</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7751em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathnormal">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⟹</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:-0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">ε</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathnormal">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:-0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">ε</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal">b</span><span class="mclose">)</span></span><span class="tag"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">2</span></span><span class="mord">)</span></span></span></span></span></span><!----></div> <p>And because <em>f</em> must be an <strong>integer number of bits</strong>, we round up</p> <div class="math math-display"><!----><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mi>f</mi><mo>≥</mo><mrow><mo fence="true">⌈</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mtext> ⁣</mtext><mfrac><mn>1</mn><mi>ϵ</mi></mfrac><mo>+</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mo stretchy="false">(</mo><mn>2</mn><mi>b</mi><mo stretchy="false">)</mo><mo fence="true">⌉</mo></mrow></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(3)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">f \ge \left\lceil \log_{2}\!\frac{1}{\epsilon} + \log_{2}(2b) \right\rceil \tag{3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">⌈</span></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:-0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">⌉</span></span></span></span><span class="tag"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">3</span></span><span class="mord">)</span></span></span></span></span></span><!----></div> <p>In practice, you can choose between <strong>8 bits</strong>, which are nicely aligned to 1 byte, or <strong>12 bits,</strong> as in the original paper. I also saw that some libraries are using <strong>16 bits</strong> per fingerprint. Those are sufficient when <strong><code>b = 4</code>.</strong></p> <table><thead><tr><th>fingerprint length (f)</th><th><span class="math math-inline"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ε</mi><mtext>bound</mtext></msub><mo>=</mo><mn>8</mn><mi mathvariant="normal">/</mi><msup><mn>2</mn><mi>f</mi></msup></mrow><annotation encoding="application/x-tex">\varepsilon_{\text{bound}} = 8/2^{f}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">bound</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-0.25em;"></span><span class="mord">8/</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span></span></span></span></span></span></span></span><!----></span></th></tr></thead><tbody><tr><td><strong>8 bits</strong></td><td><span class="math math-inline"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>8</mn><mi mathvariant="normal">/</mi><mn>256</mn><mo>=</mo><mn>0.03125</mn><mtext>  </mtext><mo stretchy="false">(</mo><mtext>  </mtext><mn>3.13</mn><mi mathvariant="normal">%</mi><mtext>  </mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">8/256 = 0.03125 \;(\;3.13\%\;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">8/256</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0.03125</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">3.13%</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mclose">)</span></span></span></span><!----></span></td></tr><tr><td><strong>12 bits</strong></td><td><span class="math math-inline"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>8</mn><mi mathvariant="normal">/</mi><mn>4096</mn><mo>=</mo><mn>0.001953</mn><mtext>  </mtext><mo stretchy="false">(</mo><mtext>  </mtext><mn>0.195</mn><mi mathvariant="normal">%</mi><mtext>  </mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">8/4096 = 0.001953\;(\;0.195\%\;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">8/4096</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0.001953</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0.195%</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mclose">)</span></span></span></span><!----></span></td></tr><tr><td><strong>16 bits</strong></td><td><span class="math math-inline"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>8</mn><mi mathvariant="normal">/</mi><mn>65536</mn><mo>=</mo><mn>0.00012207</mn><mtext>  </mtext><mo stretchy="false">(</mo><mtext>  </mtext><mn>0.0122</mn><mi mathvariant="normal">%</mi><mtext>  </mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">8/65 536 = 0.00012207\;(\;0.0122\%\;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">8/65536</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0.00012207</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0.0122%</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mclose">)</span></span></span></span><!----></span></td></tr></tbody></table> <h2 id="final-thoughts"><a class="header-anchor" aria-hidden="true" tabindex="-1" href="#final-thoughts">#</a>Final Thoughts</h2> <p>I still remember how excited I was when I learned that a Cuckoo Filter could delete elements without blowing up the data structure like other Bloom filter variants. What also surprised me was how those bucket-hopping insertions seemed unreliable on paper, but they work remarkably well in practice.
And that clever XOR trick! I’ve always had a soft spot for the bit-flip operator. Back when I studied Boolean algebra, XOR felt confusing and weirdly unnecessary. But once I understood that it could reverse itself to undo an operation, it felt like magic.</p> <p>So here’s the short takeaway: Cuckoo Filters offer Bloom-level space efficiency, support real deletions, and need only two bucket checks per lookup. In return, inserts can get a bit tricky—once the filter reaches around 95% load, they might fail unless you resize. But if you keep an eye on the load factor, it’s a trade-off worth making.</p> <p>And if you’re into XOR like I am—good news! Cuckoo Filters aren’t the only ones using it. There’s a whole family of “invertible Bloom filters” that takes this idea even further. I’m really looking forward to exploring those next.</p> <h2 id="academic-researches"><a class="header-anchor" aria-hidden="true" tabindex="-1" href="#academic-researches">#</a>Academic Researches</h2> <ul><li><a href="https://www.cs.cmu.edu/~dga/papers/cuckoo-conext2014.pdf" rel="nofollow">Cuckoo Filter: Practically Better Than Bloom</a></li> <li><a href="https://www.cs.cmu.edu/~dga/papers/silt-sosp2011.pdf" rel="nofollow">SILT: A Memory-Efficient, High-Performance Key-Value Store</a></li> <li><a href="https://people.bu.edu/staro/cuckoo_filter_workshop_paper.pdf" rel="nofollow">Birdwatching: False Negatives In Cuckoo Filters</a></li></ul><!----></div> <footer class="post-footer svelte-16vu21h"><div class="post-navigation svelte-16vu21h"><!--[--><a href="/blog" class="button primary medium svelte-1edpa7d"><!---->← Back to all posts<!----></a><!--]--><!----></div> <!--[--><!--[--><div class="series-banner svelte-2z90k"><div class="series-title svelte-2z90k">More from this series</div> <ol class="series-list svelte-2z90k"><!--[--><li class="series-item svelte-2z90k"><a href="/blog/008-bloom-filters-pt1" class="series-link svelte-2z90k">Grokking Bloom Filters: The Classic Bloom Filter Demystified</a></li><li class="series-item svelte-2z90k"><a href="/blog/009-counting-bloom-filters" class="series-link svelte-2z90k">Grokking Bloom Filters: Counting Bloom Filter</a></li><li class="series-item svelte-2z90k"><a href="/blog/010-cuckoo-filters" class="series-link svelte-2z90k">Cuckoo Filters: Better Than Bloom Filters?</a></li><!--]--></ol></div><!--]--><!--]--> <div class="card default svelte-1f4837s"><!--[!--><!--]--> <div class="card-content svelte-1f4837s"><div class="share-message svelte-16vu21h">Enjoyed this post? Share it with the universe!</div> <div class="share-buttons svelte-16vu21h"><a class="link default share-link twitter svelte-blzdii" target="_blank" rel="noopener noreferrer" href="https://twitter.com/intent/tweet?text=Cuckoo%20Filters%3A%20Better%20Than%20Bloom%20Filters%3F&amp;url=" aria-label="Share on Twitter"><!---->Twitter<!----> <!--[!--><!--]--></a><!----> <a class="link default share-link linkedin svelte-blzdii" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/shareArticle?mini=true&amp;title=Cuckoo%20Filters%3A%20Better%20Than%20Bloom%20Filters%3F&amp;url=" aria-label="Share on LinkedIn"><!---->LinkedIn<!----> <!--[!--><!--]--></a><!----> <a class="link default share-link facebook svelte-blzdii" target="_blank" rel="noopener noreferrer" href="https://www.facebook.com/sharer/sharer.php?u=" aria-label="Share on Facebook"><!---->Facebook<!----> <!--[!--><!--]--></a><!----></div><!----></div> <!--[!--><!--]--></div><!----></footer></article> <!--[--><div class="referenced-posts svelte-16vu21h"><h2 class="svelte-16vu21h">Want to read more?</h2> <div class="posts-grid svelte-1xu41xx"><!--[--><a href="/blog/009-counting-bloom-filters" class="content-card-link svelte-1e8k5qp"><div class="card neon clickable content-card svelte-1f4837s"><!--[--><!--[!--><!--]--> <!--[!--><picture class="svelte-1f4837s"><!--[--><source srcset="/_app/immutable/assets/hero.C26rI2i_.avif 1x, /_app/immutable/assets/hero.D6jfd9Ks.avif 2x" sizes="min(800px, 30vw)" type="image/avif" class="svelte-1f4837s"><source srcset="/_app/immutable/assets/hero.gGcEr26K.webp 1x, /_app/immutable/assets/hero.CbtPvtgl.webp 2x" sizes="min(800px, 30vw)" type="image/webp" class="svelte-1f4837s"><source srcset="/_app/immutable/assets/hero.DW0JbtYI.jpg 1x, /_app/immutable/assets/hero.B3c6c-mK.jpg 2x" sizes="min(800px, 30vw)" type="image/jpeg" class="svelte-1f4837s"><!--]--> <img src="/_app/immutable/assets/hero.B3c6c-mK.jpg" loading="lazy" class="cover-image real-image svelte-1f4837s" width="1536" height="1024" onload="this.__e=event" onerror="this.__e=event"></picture><!--]--><!--]--> <div class="card-content svelte-1f4837s"><!--[!--><!--]--> <div class="card-content svelte-1e8k5qp"><!--[--><span class="card-date svelte-1e8k5qp">2025-06-24</span><!--]--> <h3 class="card-title svelte-1e8k5qp">Grokking Bloom Filters: Counting Bloom Filter</h3> <p class="card-description svelte-1e8k5qp">Bloom filters can't remove elements — unless you let them count.</p> <!--[!--><!--]--> <!--[--><div class="card-tags svelte-1e8k5qp"><!--[--><span class="badge subtle small svelte-1ffaubh"><!---->Algorithms<!----></span><!--]--></div><!--]--></div><!----></div> <!--[--><div class="neon-border svelte-1f4837s"></div><!--]--></div><!----></a><a href="/blog/008-bloom-filters-pt1" class="content-card-link svelte-1e8k5qp"><div class="card neon clickable content-card svelte-1f4837s"><!--[--><!--[!--><!--]--> <!--[!--><picture class="svelte-1f4837s"><!--[--><source srcset="/_app/immutable/assets/hero.DoVjsBJ1.avif 1x, /_app/immutable/assets/hero.Bl5KWx3w.avif 2x" sizes="min(800px, 30vw)" type="image/avif" class="svelte-1f4837s"><source srcset="/_app/immutable/assets/hero.GWTMgIUX.webp 1x, /_app/immutable/assets/hero.Df6Q8ZJN.webp 2x" sizes="min(800px, 30vw)" type="image/webp" class="svelte-1f4837s"><source srcset="/_app/immutable/assets/hero.i5YRCxmZ.jpg 1x, /_app/immutable/assets/hero.BjPMHwQe.jpg 2x" sizes="min(800px, 30vw)" type="image/jpeg" class="svelte-1f4837s"><!--]--> <img src="/_app/immutable/assets/hero.BjPMHwQe.jpg" loading="lazy" class="cover-image real-image svelte-1f4837s" width="1536" height="1024" onload="this.__e=event" onerror="this.__e=event"></picture><!--]--><!--]--> <div class="card-content svelte-1f4837s"><!--[!--><!--]--> <div class="card-content svelte-1e8k5qp"><!--[--><span class="card-date svelte-1e8k5qp">2025-06-09</span><!--]--> <h3 class="card-title svelte-1e8k5qp">Grokking Bloom Filters: The Classic Bloom Filter Demystified</h3> <p class="card-description svelte-1e8k5qp">How a tiny data structure cuts memory usage by 90% — while helping systems instantly check if data exists.</p> <!--[!--><!--]--> <!--[--><div class="card-tags svelte-1e8k5qp"><!--[--><span class="badge subtle small svelte-1ffaubh"><!---->Algorithms<!----></span><!--]--></div><!--]--></div><!----></div> <!--[--><div class="neon-border svelte-1f4837s"></div><!--]--></div><!----></a><!--]--></div><!----></div><!--]--><!----></div><!----><!----><!--]--><!----></main> <footer class="svelte-1mbgpkc"><div class="space-container undefined svelte-7gsxae"><p class="space-text-small">© 2025 | Aleksey Maltsev</p><!----></div><!----></footer><!----></div><!----><!--]--> <!--[!--><!--]--><!--]-->
			
			<script>
				{
					__sveltekit_18ldk0v = {
						base: new URL("..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					Promise.all([
						import("../_app/immutable/entry/start.Dn58_4L9.js"),
						import("../_app/immutable/entry/app.CA6WAvVr.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 8],
							data: [null,{type:"data",data:{placeholderUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAXCAYAAABqBU3hAAAMEElEQVR4AQCBAH7/AAIMCv8BCwn/AQoI/wEKB/8BCQb/AQkG/wIJBf8DCQX/AwgE/wMHA/8CBgH/AQQA/wACAP8AAQD/AAEA/wADAP8DBgH/BgoG/wkOCv8LEQ7/CxMQ/wkSEP8GEQ//Ag4O/wAMDP8ACwz/AAwO/wAPEf8AExb/BBgc/wgdIP8KHyP/AIEAfv8AAgwJ/wILCf8BCwj/AQoH/wIKB/8DCgb/BAoG/wUKBv8GCgb/BgoF/wUJBP8EBwL/AwYA/wMFAP8DBQD/BAcC/wcKBf8KDgn/DRIN/w8VEf8PFhP/DRYT/wkUEv8FERD/AQ8O/wANDv8ADhD/ABET/wMVGP8HGh3/Ch4h/wwhJP8AgQB+/wADDAn/AwsJ/wMLCP8DCwj/BAsI/wUMCP8HDQn/CQ4J/wsPCv8MDwn/DA4J/wwOCP8LDQb/CwwG/wsNB/8NDwn/DxIM/xIVEP8VGRT/FhsX/xYcGf8TGxj/EBkX/wsWFP8HExL/BBIS/wMSE/8EFRb/Bxka/wsdIP8OIST/ECQm/wCBAH7/AAUMCf8FDAn/BQwJ/wYNCf8IDgn/Cg8K/wwRDP8PEw3/EhUP/xQWEP8VFhD/FhYP/xYWD/8WFg//FxcQ/xgZEv8bHBX/HR8Z/yAiHP8hJB//ICUg/x0jH/8YIB3/Ex0a/w4ZF/8KFxb/CRcX/woZGv8NHR7/ECEj/xMlJ/8VJyn/AIEAfv8ACA4K/wgOCv8JDwr/ChAL/w0RDP8QFA7/ExYQ/xcaE/8bHBX/Hh8X/yAgGP8hIRn/IiEZ/yMiGf8kIxv/JiUd/ygoIP8qKyP/LC0m/ywuKP8qLij/Jywn/yIoJP8cJCD/FiAd/xIdG/8QHRv/ER4e/xMiIf8WJib/GSkq/xssLP8AgQB+/wANEgz/DRIM/w4TDf8QFA7/ExYQ/xcZEv8cHRb/ISEZ/yUlHf8pKCD/LCoi/y4sI/8wLSP/MS4k/zIvJf8zMSf/NTMq/zc2Lf84OC//ODgw/zU3MP8xNC7/KzAq/yQqJv8eJiL/GSMf/xciH/8XIyH/GSYk/xwqKf8fLSz/IS8u/wCBAH7/ABMWD/8UFg//FRcQ/xcZEv8bHBT/HyAX/yQkHP8qKSD/Ly0k/zQxJ/84NCr/OjYs/zw3Lf89OC7/Pjkv/0A7MP9BPTP/Qj81/0NAN/9CQDf/Pz42/zk7M/8zNS7/KzAp/yUqJf8gJyL/HSUh/xwmI/8eKSb/IS0q/yQwLv8mMjD/AIEAfv8AGhsT/xocE/8cHRT/Hh8W/yIiGf8nJhz/LSsh/zMwJf85NSr/Pjku/0I8Mf9EPjP/RkA0/0dBNP9IQTX/SUM3/0pEOP9LRTr/S0Y7/0lFO/9FQzn/Pz41/zg5MP8wMiv/KS0m/yQpI/8hJyL/ICgj/yIqJv8lLir/JzEt/ykzL/8AgQB+/wAgIBf/ISAX/yIhGP8lIxr/KSYc/y4rIP8zLyT/OjUp/0A6Lv9FPjL/SUE1/0tDNv9NRTf/TkU4/05GOP9PRjn/T0c6/1BIO/9PSDz/TEc7/0hEOf9CPzX/Ozkv/zMzKf8rLST/Jikh/yMnIP8iJyH/JCok/yYtKP8pMCv/KjIt/wCBAH7/ACUjGf8mJBn/JyUa/yomHP8tKR7/Mi0i/zcyJv89Nyr/Qzwv/0hAM/9MQzX/TkU2/09FN/9QRTf/UEU3/1BGN/9QRjj/UEY4/09GOP9MRDf/SEE1/0E8Mf86Niv/MjAm/ysqIf8lJh3/IiQc/yIlHf8jKCD/Jisk/ykuKP8qMCr/AIEAfv8AKCUZ/yklGv8qJhr/LCcb/y8qHv8zLSH/ODEk/z42KP9DOiz/SD4w/0tAMv9NQTL/TUIy/01BMv9NQTH/TUEx/0xBMf9MQTL/SkAx/0g+MP9EOy7/Pjcq/zYxJf8vKx//KCUb/yMiGP8gIBf/ICEY/yIkHP8lKCD/Jysj/yktJf8AgQB+/wAoIxj/KCQY/ykkGP8rJRn/Lica/zEqHf82LiD/OzIj/0A1J/9DOCn/Rjor/0c7K/9IOir/Rzkp/0Y5KP9GOCj/RTgo/0Q4KP9DNyj/QTYn/z0zJf84LyH/MSod/yokGP8kHxT/HxwR/x0bEf8dHBP/Hx8W/yIjGv8lJx7/Jykg/wCBAH7/ACYgFP8mIBP/JiAT/yghFP8qIhX/LSQX/zEnGf81Kxz/OS4f/zwwIP8+MSH/PzEh/z8wIP8+Lx7/PS4d/zwtHP88LRz/Oy0d/zotHf85LB3/NSob/zEnGP8rIhT/JR0Q/x8ZDf8bFgv/GRYL/xoYDf8cGxH/Hx8V/yIiGf8kJBv/AIEAfv8AIRsO/yEbDv8iGw7/IhsO/yQcDv8nHRD/KiAR/y4iFP8xJRb/NCcX/zUnF/82Jxb/NSYV/zQkE/8zIxL/MiIR/zIiEf8yIxL/MiMT/zAjE/8uIhL/Kh8Q/yUbDf8gFwr/GxQH/xcSBv8WEgb/FxMJ/xkXDf8dGxH/IB8V/yEhF/8AgQB+/wAcFQn/HBUJ/xwVCP8dFQj/HhUI/yAWCf8jGAr/JhoM/ykcDf8rHg7/LR4O/y0dDf8sHAv/KxoJ/yoZCP8pGQf/KRkI/yoaCf8qGwv/KhwM/ygbDP8lGQr/IRcI/xwTBv8YEAP/FQ8C/xQPA/8VEQb/GBQK/xsZDv8eHBL/IB4U/wCBAH7/ABgRBf8YEQT/GBAE/xgQA/8ZEAP/GxED/x0TBP8gFAb/IxYH/yUXB/8mFwf/JhYG/yUVBP8kEwL/IxIB/yMSAf8kEwL/JRUE/yYXBv8nGAj/JhgI/yMXCP8gFQb/HBIE/xgPAv8VDgL/FA4D/xUQBf8YFAn/GxgN/x4bEf8gHRP/AIEAfv8AFg8D/xYOAv8WDgL/Fg0B/xcNAP8YDgH/GxAC/x0RA/8gEwT/IhQE/yMUBP8jEwP/IhIB/yEQAP8hEAD/IRAA/yIRAP8kEwP/JhYF/ycYCP8nGAn/JRgJ/yIWCP8eFAb/GhEE/xgQBP8WEAT/FxIH/xkVCv8cGQ7/HxwS/yEeFP8AgQB+/wAWDwT/Fg8D/xYOAv8WDgL/Fw4B/xkPAv8bEAL/HhIE/yATBf8iFAX/IxQF/yQUBP8jEwL/IxIB/yIRAP8jEgH/JRQD/ycWBv8pGQn/KxsM/ysdDf8pHA7/JxsN/yMYC/8fFgn/HBQI/xsUCf8bFQr/HRgO/x8bEf8iHhT/IyAW/wCBAH7/ABkTCP8ZEgf/GRIG/xkRBf8aEQX/HBIF/x4TBv8hFQj/JBcJ/yYYCv8nGQn/KBgJ/ygXB/8nFgb/KBYG/ygXB/8qGQn/LRwM/zAfEP8xIhP/MiMV/zEjFf8uIhT/Kh8S/yYcEP8iGg7/IBkO/yAaEP8hHBL/Ix8V/yUiGP8mIxr/AIEAfv8AHhgN/x4XDf8eFwz/HhYL/x8XC/8hFwv/JBkM/ycbDv8qHQ//LB4Q/y4fEP8uHxD/Lh4P/y4eDv8vHg7/MB8P/zIhEf81JBX/OCgY/zoqHP86LB3/OSwe/zYqHf8xJxr/LSQY/ykhFv8mHxX/JSAV/yYhF/8nIxr/KSUc/yonHv8AgQB+/wAkHRP/JB0T/yQdEv8kHBH/JR0R/yceEv8qHxP/LSIV/zAkFv8zJRf/NSYY/zYmF/82Jhf/NiUW/zcmFv84Jxf/Oika/z0tHf9AMCH/QjMk/0I0Jv9BNCb/PjIl/zkuIv80Kx//Lycc/ywlG/8qJRv/KiYc/ysnHv8tKSD/Lioh/wCBAH7/ACkiGP8oIhj/KCEX/ykhF/8qIhf/LCMX/y8lGf8yJxv/Nikc/zkrHv87LB7/PCwe/zwsHf88LB3/PSwd/z8uHv9BMCH/RDQk/0c3KP9JOiv/STst/0c6Lf9EOCv/PzQo/zkwJf80LCH/MCof/y4pH/8uKSD/Lyoi/zAsI/8wLST/AYEAfv8AKyUb/yslG/8rJBr/LCQa/y0lGv8vJhv/Migc/zYqHv85LSD/PC8h/z4wIv8/MCH/QDAh/0AvIP9BMCH/QjEi/0U0Jf9INyj/Szss/0w9L/9NPzH/Sz4x/0c7L/9CNyv/PDMo/zcvJP8zLCL/MSsh/zArIv8wLCP/MS4l/zIuJv8UoPBs0coZdQAAAABJRU5ErkJggg==",views:1650,ogImagePath:"/images/og/010-cuckoo-filters.jpg"},uses:{params:["slug"]}}],
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
