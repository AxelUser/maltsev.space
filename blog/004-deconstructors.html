<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/png" href="../favicon-96x96.png" sizes="96x96" />
		<link rel="icon" type="image/svg+xml" href="../favicon.svg" />
		<link rel="shortcut icon" href="../favicon.ico" />
		<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png" />
		<meta name="apple-mobile-web-app-title" content="Maltsev.Space" />
		<link rel="manifest" href="../site.webmanifest" />
		<meta
			name="viewport"
			content="width=device-width, initial-scale=1, maximum-scale=5, viewport-fit=cover"
		/>
		
		<link href="../_app/immutable/assets/link.lfBZP6gP.css" rel="stylesheet">
		<link href="../_app/immutable/assets/tag-cloud.Tiap62dV.css" rel="stylesheet">
		<link href="../_app/immutable/assets/0.Ev2lDQ97.css" rel="stylesheet">
		<link href="../_app/immutable/assets/5.BPVSJhiw.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/entry/start.BTmCBczf.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DJTtuI5-.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/D5usNJhD.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CYgJF_JY.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/atb5tliA.js">
		<link rel="modulepreload" href="../_app/immutable/entry/app.gU2dyjkM.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Dp1pzeXC.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/C7MaNpgc.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DmikqdVb.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/tIEfHnyc.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/0.6UZ6hAgw.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CJpBXX6n.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Clzlhha8.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/H9wuWRTD.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Bp2Dm2TW.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BCQ5r3qw.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/5.CHnBIgjJ.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BgLUtFZr.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BxW7COlu.js"><!--[--><link rel="alternate" type="application/rss+xml" title="Aleksey Maltsev's Blog" href="/rss.xml"><!--]--><!--[--><!--]--><title>Benefits of deconstructors for custom types | MALTSEV.SPACE</title>
	</head>

	<body data-sveltekit-preload-data="hover">
		<div style="display: contents"><!--[--><!--[--><!----><div class="space-layout svelte-144yekp"><header class="svelte-yqzv1j"><nav class="space-container svelte-yqzv1j"><div class="logo svelte-yqzv1j"><a href="/" class="svelte-yqzv1j">MALTSEV.SPACE</a></div> <ul class="nav-links svelte-yqzv1j"><li><a class="nav-link svelte-yqzv1j" href="/">Home</a></li> <li><a class="nav-link svelte-yqzv1j" href="/about">About</a></li> <li><a class="nav-link svelte-yqzv1j" href="/blog">Blog</a></li></ul> <div class="nav-actions svelte-yqzv1j"><a href="/rss.xml" class="rss-link nav-link svelte-yqzv1j" aria-label="RSS Feed"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" class="lucide-icon lucide lucide-rss"><!--[--><!----><path d="M4 11a9 9 0 0 1 9 9"><!----></path><!----><!----><path d="M4 4a16 16 0 0 1 16 16"><!----></path><!----><!----><circle cx="5" cy="19" r="1"><!----></circle><!----><!--]--><!----><!----></svg><!----></a> <div class="theme-switch svelte-awph5w"><button class="theme-button svelte-awph5w" title="Light theme" aria-label="Light theme"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-sun"><!--[--><!----><circle cx="12" cy="12" r="4"><!----></circle><!----><!----><path d="M12 2v2"><!----></path><!----><!----><path d="M12 20v2"><!----></path><!----><!----><path d="m4.93 4.93 1.41 1.41"><!----></path><!----><!----><path d="m17.66 17.66 1.41 1.41"><!----></path><!----><!----><path d="M2 12h2"><!----></path><!----><!----><path d="M20 12h2"><!----></path><!----><!----><path d="m6.34 17.66-1.41 1.41"><!----></path><!----><!----><path d="m19.07 4.93-1.41 1.41"><!----></path><!----><!--]--><!----><!----></svg><!----></button> <button class="theme-button svelte-awph5w" title="Dark theme" aria-label="Dark theme"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-moon"><!--[--><!----><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"><!----></path><!----><!--]--><!----><!----></svg><!----></button> <button class="theme-button svelte-awph5w active" title="System theme" aria-label="System theme"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-laptop"><!--[--><!----><path d="M20 16V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v9m16 0H4m16 0 1.28 2.55a1 1 0 0 1-.9 1.45H3.62a1 1 0 0 1-.9-1.45L4 16"><!----></path><!----><!--]--><!----><!----></svg><!----></button></div><!----> <button class="mobile-menu-toggle svelte-yqzv1j" aria-label="Toggle menu"><!--[!--><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" class="lucide-icon lucide lucide-menu"><!--[--><!----><path d="M4 12h16"><!----></path><!----><!----><path d="M4 18h16"><!----></path><!----><!----><path d="M4 6h16"><!----></path><!----><!--]--><!----><!----></svg><!--]--></button></div></nav> <div class="mobile-nav svelte-yqzv1j"><ul class="svelte-yqzv1j"><li class="svelte-yqzv1j"><a class="nav-link svelte-yqzv1j" href="/">Home</a></li> <li class="svelte-yqzv1j"><a class="nav-link svelte-yqzv1j" href="/about">About</a></li> <li class="svelte-yqzv1j"><a class="nav-link svelte-yqzv1j" href="/blog">Blog</a></li></ul></div></header><!----> <div class="stars-background svelte-1xnwqdy"><!--[--><!--]--></div><!----> <main class="svelte-144yekp"><div class="space-container"><!----><!--[--><div class="hero-background-container svelte-17kp2kb"><img src="/images/blog/004-deconstructors/hero.jpg" alt="Benefits of deconstructors for custom types hero image" loading="lazy" class="hero-background-image svelte-17kp2kb"> <div class="hero-content svelte-17kp2kb"><hgroup class="svelte-17kp2kb"><h1 class="space-title svelte-17kp2kb">Benefits of deconstructors for custom types</h1> <p class="svelte-17kp2kb"><span>Published at <time datetime="2024-06-15">2018-11-15</time></span></p></hgroup></div></div><!--]--> <article class="svelte-17kp2kb"><!--[!--><!--]--> <div class="post-navigation top-navigation svelte-17kp2kb"><!--[--><a href="/blog" class="button primary medium svelte-6ghmor"><!---->← Back to all posts<!----></a><!--]--><!----></div> <div class="prose"><h2 id="about-tuples-in-c-7"><a class="header-anchor" aria-hidden="true" tabindex="-1" href="#about-tuples-in-c-7">#</a>About tuples in C# 7</h2> <p>New tuples and its support in C# 7 are blazing-cool:</p> <ul><li>they are structures, so no heap allocations;</li> <li>they have aliases for names of its fields (<code>tuple.Info</code> vs old <code>tuple.Item1</code>);</li> <li>they bring syntax-sugar of deconstruction;</li></ul> <p>Moreover, the deconstruction can be used not only for build-in tuples, but also for your own classes and structures.</p> <h2 id="deconstruction-for-tuples"><a class="header-anchor" aria-hidden="true" tabindex="-1" href="#deconstruction-for-tuples">#</a>Deconstruction for tuples</h2> <p>Let’s start with the original usage for tuples. If you are already familiar with it, you may jump to <a href="#implementing-deconstruction-for-custom-types">the next block</a>.</p> <p>For example, you have a method, which returns a statistic about most frequent word in a form of a tuple with two fields: word and count. Below is the example of such method:</p> <!----><pre class="shiki shiki-themes material-theme-palenight github-dark" style="background-color:#292D3E;--shiki-dark-bg:#24292e;color:#babed8;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#C792EA;--shiki-dark:#F97583">static</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8"> (</span><span style="color:#89DDFF;--shiki-dark:#F97583">string</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">,</span><span style="color:#89DDFF;--shiki-dark:#F97583"> int</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span><span style="color:#82AAFF;--shiki-dark:#B392F0"> GetMostFrequentWord</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#89DDFF;--shiki-dark:#F97583">string</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> text</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#123;</span></span>
<span class="line"><span style="color:#FFCB6B;--shiki-dark:#F97583">    var</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> group</span><span style="color:#89DDFF;--shiki-dark:#F97583"> =</span><span style="color:#BABED8;--shiki-dark:#E1E4E8"> text</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">.</span><span style="color:#82AAFF;--shiki-dark:#B392F0">Split</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">'</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF"> '</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">        .</span><span style="color:#82AAFF;--shiki-dark:#B392F0">GroupBy</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#FFCB6B;--shiki-dark:#B392F0">s</span><span style="color:#89DDFF;--shiki-dark:#F97583"> =></span><span style="color:#BABED8;--shiki-dark:#E1E4E8"> s</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">        .</span><span style="color:#82AAFF;--shiki-dark:#B392F0">OrderByDescending</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#FFCB6B;--shiki-dark:#B392F0">grouping</span><span style="color:#89DDFF;--shiki-dark:#F97583"> =></span><span style="color:#BABED8;--shiki-dark:#E1E4E8"> grouping</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">.</span><span style="color:#82AAFF;--shiki-dark:#B392F0">Count</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">())</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">        .</span><span style="color:#82AAFF;--shiki-dark:#B392F0">First</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;--shiki-dark:#F97583;--shiki-dark-font-style:inherit">    return</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8"> (</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">group</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">.</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">Key</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">,</span><span style="color:#BABED8;--shiki-dark:#E1E4E8"> group</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">.</span><span style="color:#82AAFF;--shiki-dark:#B392F0">Count</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">());</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#125;</span></span></code></pre><!----> <p>As you see, <code>GetMostFrequentWord</code> returns unnamed tuple, and you can access its fields via <code>Item1</code> and <code>Item2</code>:</p> <!----><pre class="shiki shiki-themes material-theme-palenight github-dark" style="background-color:#292D3E;--shiki-dark-bg:#24292e;color:#babed8;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#C792EA;--shiki-dark:#F97583">static</span><span style="color:#89DDFF;--shiki-dark:#F97583"> void</span><span style="color:#82AAFF;--shiki-dark:#B392F0"> Main</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#89DDFF;--shiki-dark:#F97583">string</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">[]</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> args</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#123;</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#F97583">    string</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> text</span><span style="color:#89DDFF;--shiki-dark:#F97583"> =</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF"> "</span><span style="color:#C3E88D;--shiki-dark:#9ECBFF">tuple for testing tuple</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">"</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#FFCB6B;--shiki-dark:#F97583">    var</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> stat</span><span style="color:#89DDFF;--shiki-dark:#F97583"> =</span><span style="color:#82AAFF;--shiki-dark:#B392F0"> GetMostFrequentWord</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">text</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#BABED8;--shiki-dark:#E1E4E8">    Trace</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">.</span><span style="color:#82AAFF;--shiki-dark:#B392F0">WriteLine</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">$"</span><span style="color:#C3E88D;--shiki-dark:#9ECBFF">word: </span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#123;</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">stat</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">.</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">Item1</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#125;</span><span style="color:#C3E88D;--shiki-dark:#9ECBFF">, count: </span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#123;</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">stat</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">.</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">Item2</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#125;"</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#125;</span></span></code></pre><!----> <p>On the other hand, if you implement named-tuple, those values can be accessed through aliases, you just need to make some changes into declaration of the tuple:</p> <!----><pre class="shiki shiki-themes material-theme-palenight github-dark" style="background-color:#292D3E;--shiki-dark-bg:#24292e;color:#babed8;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit">// we added aliases for the output below</span></span>
<span class="line"><span style="color:#C792EA;--shiki-dark:#F97583">static</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8"> (</span><span style="color:#89DDFF;--shiki-dark:#F97583">string</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> word</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">,</span><span style="color:#89DDFF;--shiki-dark:#F97583"> int</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> count</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span><span style="color:#82AAFF;--shiki-dark:#B392F0"> GetMostFrequentWord</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#89DDFF;--shiki-dark:#F97583">string</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> text</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#123;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit">    // same logic</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#125;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;--shiki-dark:#F97583">static</span><span style="color:#89DDFF;--shiki-dark:#F97583"> void</span><span style="color:#82AAFF;--shiki-dark:#B392F0"> Main</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#89DDFF;--shiki-dark:#F97583">string</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">[]</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> args</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#123;</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#F97583">    string</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> text</span><span style="color:#89DDFF;--shiki-dark:#F97583"> =</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF"> "</span><span style="color:#C3E88D;--shiki-dark:#9ECBFF">tuple for testing tuple</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">"</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#FFCB6B;--shiki-dark:#F97583">    var</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> stat</span><span style="color:#89DDFF;--shiki-dark:#F97583"> =</span><span style="color:#82AAFF;--shiki-dark:#B392F0"> GetMostFrequentWord</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">text</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit">    // but now we use aliases for fields</span></span>
<span class="line"><span style="color:#BABED8;--shiki-dark:#E1E4E8">    Trace</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">.</span><span style="color:#82AAFF;--shiki-dark:#B392F0">WriteLine</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">$"</span><span style="color:#C3E88D;--shiki-dark:#9ECBFF">word: </span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#123;</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">stat</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">.</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">word</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#125;</span><span style="color:#C3E88D;--shiki-dark:#9ECBFF">, count: </span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#123;</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">stat</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">.</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">count</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#125;"</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#125;</span></span></code></pre><!----> <p>However, our original need is just getting those fields <code>word</code> and <code>count</code>, we don’t really care about grouping tuple. So be it: with the help of deconstruction, we can initialize only variables <code>word</code> and <code>count</code>:</p> <!----><pre class="shiki shiki-themes material-theme-palenight github-dark" style="background-color:#292D3E;--shiki-dark-bg:#24292e;color:#babed8;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#C792EA;--shiki-dark:#F97583">static</span><span style="color:#89DDFF;--shiki-dark:#F97583"> void</span><span style="color:#82AAFF;--shiki-dark:#B392F0"> Main</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#89DDFF;--shiki-dark:#F97583">string</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">[]</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> args</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#123;</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#F97583">    string</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> text</span><span style="color:#89DDFF;--shiki-dark:#F97583"> =</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF"> "</span><span style="color:#C3E88D;--shiki-dark:#9ECBFF">tuple for testing tuple</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">"</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit">    // no tuple now, just values from its fields</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">    (</span><span style="color:#89DDFF;--shiki-dark:#F97583">string</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> word</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">,</span><span style="color:#89DDFF;--shiki-dark:#F97583"> int</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> count</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span><span style="color:#89DDFF;--shiki-dark:#F97583"> =</span><span style="color:#82AAFF;--shiki-dark:#B392F0"> GetMostFrequentWord</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">text</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#BABED8;--shiki-dark:#E1E4E8">    Trace</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">.</span><span style="color:#82AAFF;--shiki-dark:#B392F0">WriteLine</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">$"</span><span style="color:#C3E88D;--shiki-dark:#9ECBFF">word: </span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#123;</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">word</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#125;</span><span style="color:#C3E88D;--shiki-dark:#9ECBFF">, count: </span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#123;</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">count</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#125;"</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#125;</span></span></code></pre><!----> <p>In addition, you can even use <code>var</code> for completely deconstructed tuple, instead of specifying explicit types for every field:</p> <!----><pre class="shiki shiki-themes material-theme-palenight github-dark" style="background-color:#292D3E;--shiki-dark-bg:#24292e;color:#babed8;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;--shiki-dark:#F97583">var</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8"> (</span><span style="color:#FFCB6B;--shiki-dark:#B392F0">word</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">,</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> count</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span><span style="color:#89DDFF;--shiki-dark:#F97583"> =</span><span style="color:#82AAFF;--shiki-dark:#B392F0"> GetMostFrequentWord</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">text</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">);</span></span></code></pre><!----> <p>If you don’t need some fields from deconstruction, you can use another feature of C# 7 - <a href="https://docs.microsoft.com/ru-ru/dotnet/csharp/discards" rel="nofollow">discards</a>. For example, if we want to discard the creation of variable <code>count</code> during deconstruction, we can pass <code>_</code> instead:</p> <!----><pre class="shiki shiki-themes material-theme-palenight github-dark" style="background-color:#292D3E;--shiki-dark-bg:#24292e;color:#babed8;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#C792EA;--shiki-dark:#F97583">static</span><span style="color:#89DDFF;--shiki-dark:#F97583"> void</span><span style="color:#82AAFF;--shiki-dark:#B392F0"> Main</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#89DDFF;--shiki-dark:#F97583">string</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">[]</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> args</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#123;</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#F97583">    string</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> text</span><span style="color:#89DDFF;--shiki-dark:#F97583"> =</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF"> "</span><span style="color:#C3E88D;--shiki-dark:#9ECBFF">tuple for testing tuple</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">"</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#FFCB6B;--shiki-dark:#F97583">    var</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8"> (</span><span style="color:#FFCB6B;--shiki-dark:#B392F0">word</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">,</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> _</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span><span style="color:#89DDFF;--shiki-dark:#F97583"> =</span><span style="color:#82AAFF;--shiki-dark:#B392F0"> GetMostFrequentWord</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">text</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#BABED8;--shiki-dark:#E1E4E8">    Trace</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">.</span><span style="color:#82AAFF;--shiki-dark:#B392F0">WriteLine</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">$"</span><span style="color:#C3E88D;--shiki-dark:#9ECBFF">Most frequent word: </span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#123;</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">word</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#125;"</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#125;</span></span></code></pre><!----> <h2 id="implementing-deconstruction-for-custom-types"><a class="header-anchor" aria-hidden="true" tabindex="-1" href="#implementing-deconstruction-for-custom-types">#</a>Implementing deconstruction for custom types</h2> <p>Using deconstruction of tuples is quite straightforward, how about user-defined types? You may want <code>GetMostFrequentWord</code> to return your own struct <code>WordStat</code>:</p> <!----><pre class="shiki shiki-themes material-theme-palenight github-dark" style="background-color:#292D3E;--shiki-dark-bg:#24292e;color:#babed8;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#C792EA;--shiki-dark:#F97583">public</span><span style="color:#FFCB6B;--shiki-dark:#F97583"> struct</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> WordStat</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#123;</span></span>
<span class="line"><span style="color:#C792EA;--shiki-dark:#F97583">    public</span><span style="color:#89DDFF;--shiki-dark:#F97583"> string</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> Word</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8"> &#123;</span><span style="color:#FFCB6B;--shiki-dark:#F97583"> get</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">;</span><span style="color:#FFCB6B;--shiki-dark:#F97583"> set</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">;</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8"> &#125;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;--shiki-dark:#F97583">    public</span><span style="color:#89DDFF;--shiki-dark:#F97583"> int</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> Count</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8"> &#123;</span><span style="color:#FFCB6B;--shiki-dark:#F97583"> get</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">;</span><span style="color:#FFCB6B;--shiki-dark:#F97583"> set</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">;</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8"> &#125;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;--shiki-dark:#F97583">    public</span><span style="color:#82AAFF;--shiki-dark:#B392F0"> WordStat</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#89DDFF;--shiki-dark:#F97583">string</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> word</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">,</span><span style="color:#89DDFF;--shiki-dark:#F97583"> int</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> count</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">    &#123;</span></span>
<span class="line"><span style="color:#BABED8;--shiki-dark:#E1E4E8">        Word </span><span style="color:#89DDFF;--shiki-dark:#F97583">=</span><span style="color:#BABED8;--shiki-dark:#E1E4E8"> word</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#BABED8;--shiki-dark:#E1E4E8">        Count </span><span style="color:#89DDFF;--shiki-dark:#F97583">=</span><span style="color:#BABED8;--shiki-dark:#E1E4E8"> count</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">    &#125;</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#125;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;--shiki-dark:#F97583">static</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> WordStat</span><span style="color:#82AAFF;--shiki-dark:#B392F0"> GetMostFrequentWordStats</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#89DDFF;--shiki-dark:#F97583">string</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> text</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#123;</span></span>
<span class="line"><span style="color:#FFCB6B;--shiki-dark:#F97583">    var</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> group</span><span style="color:#89DDFF;--shiki-dark:#F97583"> =</span><span style="color:#BABED8;--shiki-dark:#E1E4E8"> text</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">.</span><span style="color:#82AAFF;--shiki-dark:#B392F0">Split</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">'</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF"> '</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">        .</span><span style="color:#82AAFF;--shiki-dark:#B392F0">GroupBy</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#FFCB6B;--shiki-dark:#B392F0">s</span><span style="color:#89DDFF;--shiki-dark:#F97583"> =></span><span style="color:#BABED8;--shiki-dark:#E1E4E8"> s</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">        .</span><span style="color:#82AAFF;--shiki-dark:#B392F0">OrderByDescending</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#FFCB6B;--shiki-dark:#B392F0">grouping</span><span style="color:#89DDFF;--shiki-dark:#F97583"> =></span><span style="color:#BABED8;--shiki-dark:#E1E4E8"> grouping</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">.</span><span style="color:#82AAFF;--shiki-dark:#B392F0">Count</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">())</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">        .</span><span style="color:#82AAFF;--shiki-dark:#B392F0">First</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;--shiki-dark:#F97583;--shiki-dark-font-style:inherit">    return</span><span style="color:#89DDFF;--shiki-dark:#F97583"> new</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> WordStat</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">group</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">.</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">Key</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">,</span><span style="color:#BABED8;--shiki-dark:#E1E4E8"> group</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">.</span><span style="color:#82AAFF;--shiki-dark:#B392F0">Count</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">());</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#125;</span></span></code></pre><!----> <p>Generic tuples are great, but there are several reasons for using your own models:</p> <ul><li>Better readability, as your code became less “technical”.</li> <li>Easy refactoring, for example, if you want to change field names or add new ones.</li> <li>Your model has domain specifics, but generic tuples - doesn’t.</li></ul> <p>So, we will use <code>WordStat</code> instead of a tuple, but can we use deconstruction for our model?</p> <p>We are lucky because we can add this feature to our type. All is needed is adding new public method <code>Deconstruct</code> with <code>out</code> parameters, that will be extracted during deconstruction:</p> <!----><pre class="shiki shiki-themes material-theme-palenight github-dark" style="background-color:#292D3E;--shiki-dark-bg:#24292e;color:#babed8;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#C792EA;--shiki-dark:#F97583">public</span><span style="color:#89DDFF;--shiki-dark:#F97583"> void</span><span style="color:#82AAFF;--shiki-dark:#B392F0"> Deconstruct</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#C792EA;--shiki-dark:#F97583">out</span><span style="color:#89DDFF;--shiki-dark:#F97583"> string</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> word</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">,</span><span style="color:#C792EA;--shiki-dark:#F97583"> out</span><span style="color:#89DDFF;--shiki-dark:#F97583"> int</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> count</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#123;</span></span>
<span class="line"><span style="color:#BABED8;--shiki-dark:#E1E4E8">    word </span><span style="color:#89DDFF;--shiki-dark:#F97583">=</span><span style="color:#BABED8;--shiki-dark:#E1E4E8"> Word</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#BABED8;--shiki-dark:#E1E4E8">    count </span><span style="color:#89DDFF;--shiki-dark:#F97583">=</span><span style="color:#BABED8;--shiki-dark:#E1E4E8"> Count</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#125;</span></span></code></pre><!----> <p>After that, smart compiler will use this method to produce deconstructed values:</p> <!----><pre class="shiki shiki-themes material-theme-palenight github-dark" style="background-color:#292D3E;--shiki-dark-bg:#24292e;color:#babed8;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#C792EA;--shiki-dark:#F97583">static</span><span style="color:#89DDFF;--shiki-dark:#F97583"> void</span><span style="color:#82AAFF;--shiki-dark:#B392F0"> Main</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#89DDFF;--shiki-dark:#F97583">string</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">[]</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> args</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#123;</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#F97583">    string</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> text</span><span style="color:#89DDFF;--shiki-dark:#F97583"> =</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF"> "</span><span style="color:#C3E88D;--shiki-dark:#9ECBFF">tuple for testing tuple</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">"</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit">    // visually nothing has changed</span></span>
<span class="line"><span style="color:#FFCB6B;--shiki-dark:#F97583">    var</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8"> (</span><span style="color:#FFCB6B;--shiki-dark:#B392F0">word</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">,</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> count</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span><span style="color:#89DDFF;--shiki-dark:#F97583"> =</span><span style="color:#82AAFF;--shiki-dark:#B392F0"> GetMostFrequentWordStats</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">text</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#BABED8;--shiki-dark:#E1E4E8">    Trace</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">.</span><span style="color:#82AAFF;--shiki-dark:#B392F0">WriteLine</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">$"</span><span style="color:#C3E88D;--shiki-dark:#9ECBFF">word: </span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#123;</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">word</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#125;</span><span style="color:#C3E88D;--shiki-dark:#9ECBFF">, count: </span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#123;</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">count</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#125;"</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#125;</span></span></code></pre><!----> <p>Deconstructed fields must be of same types and in same order and count, as they appear in <code>Deconstruct</code>. You can have as many configurations of deconstruction, as how many overrides of <code>Deconstruct</code> you have.
One more thing - <code>Deconstruct</code> may be an extension-method!</p> <p>Let’s add a new field <code>WordLength</code> to <code>WordStat</code> and write an extension to get all those three fields:</p> <!----><pre class="shiki shiki-themes material-theme-palenight github-dark" style="background-color:#292D3E;--shiki-dark-bg:#24292e;color:#babed8;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#C792EA;--shiki-dark:#F97583">public</span><span style="color:#C792EA;--shiki-dark:#F97583"> static</span><span style="color:#FFCB6B;--shiki-dark:#F97583"> class</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> Extensions</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#123;</span></span>
<span class="line"><span style="color:#C792EA;--shiki-dark:#F97583">    public</span><span style="color:#C792EA;--shiki-dark:#F97583"> static</span><span style="color:#89DDFF;--shiki-dark:#F97583"> void</span><span style="color:#82AAFF;--shiki-dark:#B392F0"> Deconstruct</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#C792EA;--shiki-dark:#F97583">this</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> Program</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">.</span><span style="color:#FFCB6B;--shiki-dark:#B392F0">WordStat</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> stat</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">,</span><span style="color:#C792EA;--shiki-dark:#F97583"> out</span><span style="color:#89DDFF;--shiki-dark:#F97583"> string</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> word</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">,</span><span style="color:#C792EA;--shiki-dark:#F97583"> out</span><span style="color:#89DDFF;--shiki-dark:#F97583"> int</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> count</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">,</span><span style="color:#C792EA;--shiki-dark:#F97583"> out</span><span style="color:#89DDFF;--shiki-dark:#F97583"> int</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> length</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">    &#123;</span></span>
<span class="line"><span style="color:#BABED8;--shiki-dark:#E1E4E8">        word </span><span style="color:#89DDFF;--shiki-dark:#F97583">=</span><span style="color:#BABED8;--shiki-dark:#E1E4E8"> stat</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">.</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">Word</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#BABED8;--shiki-dark:#E1E4E8">        count </span><span style="color:#89DDFF;--shiki-dark:#F97583">=</span><span style="color:#BABED8;--shiki-dark:#E1E4E8"> stat</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">.</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">Count</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#BABED8;--shiki-dark:#E1E4E8">        length </span><span style="color:#89DDFF;--shiki-dark:#F97583">=</span><span style="color:#BABED8;--shiki-dark:#E1E4E8"> stat</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">.</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">WordLength</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">    &#125;</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#125;</span></span></code></pre><!----> <p>Now we can get word’s length from deconstruction:</p> <!----><pre class="shiki shiki-themes material-theme-palenight github-dark" style="background-color:#292D3E;--shiki-dark-bg:#24292e;color:#babed8;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#C792EA;--shiki-dark:#F97583">static</span><span style="color:#89DDFF;--shiki-dark:#F97583"> void</span><span style="color:#82AAFF;--shiki-dark:#B392F0"> Main</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#89DDFF;--shiki-dark:#F97583">string</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">[]</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> args</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#123;</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#F97583">    string</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> text</span><span style="color:#89DDFF;--shiki-dark:#F97583"> =</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF"> "</span><span style="color:#C3E88D;--shiki-dark:#9ECBFF">tuple for testing tuple</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">"</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#FFCB6B;--shiki-dark:#F97583">    var</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8"> (</span><span style="color:#FFCB6B;--shiki-dark:#B392F0">word</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">,</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> count</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">,</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> length</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span><span style="color:#89DDFF;--shiki-dark:#F97583"> =</span><span style="color:#82AAFF;--shiki-dark:#B392F0"> GetMostFrequentWordStats</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">text</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#BABED8;--shiki-dark:#E1E4E8">    Trace</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">.</span><span style="color:#82AAFF;--shiki-dark:#B392F0">WriteLine</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">$"</span><span style="color:#C3E88D;--shiki-dark:#9ECBFF">word: </span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#123;</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">word</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#125;</span><span style="color:#C3E88D;--shiki-dark:#9ECBFF">, count: </span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#123;</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">count</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#125;</span><span style="color:#C3E88D;--shiki-dark:#9ECBFF">, length: </span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#123;</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">length</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#125;"</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#125;</span></span></code></pre><!----> <h2 id="use-cases-of-deconstruction"><a class="header-anchor" aria-hidden="true" tabindex="-1" href="#use-cases-of-deconstruction">#</a>Use-cases of deconstruction</h2> <p>Imagine a service, which sends you some data, for example aggregational count of some records in some data-sources. Method takes a long time to aggregate. Let’s say it’s signature will be:</p> <!----><pre class="shiki shiki-themes material-theme-palenight github-dark" style="background-color:#292D3E;--shiki-dark-bg:#24292e;color:#babed8;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;--shiki-dark:#B392F0">Task</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#x3C;</span><span style="color:#89DDFF;--shiki-dark:#F97583">int</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">></span><span style="color:#82AAFF;--shiki-dark:#B392F0"> Count</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#89DDFF;--shiki-dark:#F97583">string</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">[]</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> dataSourcesUrls</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">);</span></span></code></pre><!----> <p>What if service failed, while retrieving count; or even more complicated - it failed only for several sources. What will be the result of <code>Count</code>: partial count, <code>default(int)</code>, <code>-1</code>, <code>null</code> (if it will be <code>Nullable&lt;int></code>)? Or maybe <code>Count</code> will throw an exception?</p> <p>One approach is to use complex type as a result; often it is named as <strong>Operation Result</strong>. It usually consists of requested data and some information about errors, which have been occurred (or not). Below is the example:</p> <!----><pre class="shiki shiki-themes material-theme-palenight github-dark" style="background-color:#292D3E;--shiki-dark-bg:#24292e;color:#babed8;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit">// Our service</span></span>
<span class="line"><span style="color:#C792EA;--shiki-dark:#F97583">public</span><span style="color:#FFCB6B;--shiki-dark:#F97583"> class</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> AggregationService</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#123;</span></span>
<span class="line"><span style="color:#C792EA;--shiki-dark:#F97583">    public</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> Task</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#x3C;</span><span style="color:#FFCB6B;--shiki-dark:#B392F0">OperationResult</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#x3C;</span><span style="color:#89DDFF;--shiki-dark:#F97583">int</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">>></span><span style="color:#82AAFF;--shiki-dark:#B392F0"> Count</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#89DDFF;--shiki-dark:#F97583">string</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">[]</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> dataSourcesUrls</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">    &#123;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;--shiki-dark:#F97583;--shiki-dark-font-style:inherit">        return</span><span style="color:#BABED8;--shiki-dark:#E1E4E8"> Task</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">.</span><span style="color:#82AAFF;--shiki-dark:#B392F0">FromResult</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span></span>
<span class="line"><span style="color:#BABED8;--shiki-dark:#E1E4E8">            OperationResult</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#x3C;</span><span style="color:#89DDFF;--shiki-dark:#F97583">int</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">>.</span><span style="color:#82AAFF;--shiki-dark:#B392F0">CreatePartly</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#F78C6C;--shiki-dark:#79B8FF">100</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#F97583">                new</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> Exception</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">$"</span><span style="color:#C3E88D;--shiki-dark:#9ECBFF">Data from url '</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#123;</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">dataSourcesUrls</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">[</span><span style="color:#F78C6C;--shiki-dark:#79B8FF">0</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">]&#125;</span><span style="color:#C3E88D;--shiki-dark:#9ECBFF">' was not loaded, but it's OK, go on</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">"</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)));</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">    &#125;</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#125;</span></span></code></pre><!----> <!----><pre class="shiki shiki-themes material-theme-palenight github-dark" style="background-color:#292D3E;--shiki-dark-bg:#24292e;color:#babed8;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit">// Complex result</span></span>
<span class="line"><span style="color:#C792EA;--shiki-dark:#F97583">public</span><span style="color:#FFCB6B;--shiki-dark:#F97583"> class</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> OperationResult</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#x3C;</span><span style="color:#FFCB6B;--shiki-dark:#B392F0">TResult</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">></span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#123;</span></span>
<span class="line"><span style="color:#C792EA;--shiki-dark:#F97583">    private</span><span style="color:#82AAFF;--shiki-dark:#B392F0"> OperationResult</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">()</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">    &#123;</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">    &#125;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;--shiki-dark:#F97583">    public</span><span style="color:#89DDFF;--shiki-dark:#F97583"> bool</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> Success</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8"> &#123;</span><span style="color:#FFCB6B;--shiki-dark:#F97583"> get</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">;</span><span style="color:#C792EA;--shiki-dark:#F97583"> private</span><span style="color:#FFCB6B;--shiki-dark:#F97583"> set</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">;</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8"> &#125;</span></span>
<span class="line"><span style="color:#C792EA;--shiki-dark:#F97583">    public</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> TResult</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> Result</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8"> &#123;</span><span style="color:#FFCB6B;--shiki-dark:#F97583"> get</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">;</span><span style="color:#C792EA;--shiki-dark:#F97583"> private</span><span style="color:#FFCB6B;--shiki-dark:#F97583"> set</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">;</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8"> &#125;</span></span>
<span class="line"><span style="color:#C792EA;--shiki-dark:#F97583">    public</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> Exception</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> Exception</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8"> &#123;</span><span style="color:#FFCB6B;--shiki-dark:#F97583"> get</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">;</span><span style="color:#C792EA;--shiki-dark:#F97583"> private</span><span style="color:#FFCB6B;--shiki-dark:#F97583"> set</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">;</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8"> &#125;</span></span>
<span class="line"><span style="color:#C792EA;--shiki-dark:#F97583">    public</span><span style="color:#89DDFF;--shiki-dark:#F97583"> bool</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> IsTotallySuccessful</span><span style="color:#89DDFF;--shiki-dark:#F97583"> =></span><span style="color:#BABED8;--shiki-dark:#E1E4E8"> Success </span><span style="color:#89DDFF;--shiki-dark:#F97583">&#x26;&#x26;</span><span style="color:#BABED8;--shiki-dark:#E1E4E8"> Exception </span><span style="color:#89DDFF;--shiki-dark:#F97583">==</span><span style="color:#89DDFF;--shiki-dark:#79B8FF"> null</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit">    // Factories</span></span>
<span class="line"><span style="color:#C792EA;--shiki-dark:#F97583">    public</span><span style="color:#C792EA;--shiki-dark:#F97583"> static</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> OperationResult</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#x3C;</span><span style="color:#FFCB6B;--shiki-dark:#B392F0">TResult</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">></span><span style="color:#82AAFF;--shiki-dark:#B392F0"> CreateSuccessful</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#FFCB6B;--shiki-dark:#B392F0">TResult</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> result</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">    &#123;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;--shiki-dark:#F97583;--shiki-dark-font-style:inherit">        return</span><span style="color:#89DDFF;--shiki-dark:#F97583"> new</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> OperationResult</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#x3C;</span><span style="color:#FFCB6B;--shiki-dark:#B392F0">TResult</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">></span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">        &#123;</span></span>
<span class="line"><span style="color:#BABED8;--shiki-dark:#E1E4E8">            Success </span><span style="color:#89DDFF;--shiki-dark:#F97583">=</span><span style="color:#FF9CAC;--shiki-dark:#79B8FF"> true</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#BABED8;--shiki-dark:#E1E4E8">            Result </span><span style="color:#89DDFF;--shiki-dark:#F97583">=</span><span style="color:#BABED8;--shiki-dark:#E1E4E8"> result</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">        &#125;;</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">    &#125;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;--shiki-dark:#F97583">    public</span><span style="color:#C792EA;--shiki-dark:#F97583"> static</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> OperationResult</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#x3C;</span><span style="color:#FFCB6B;--shiki-dark:#B392F0">TResult</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">></span><span style="color:#82AAFF;--shiki-dark:#B392F0"> CreatePartly</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#FFCB6B;--shiki-dark:#B392F0">TResult</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> result</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">,</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> Exception</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> e</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">    &#123;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;--shiki-dark:#F97583;--shiki-dark-font-style:inherit">        return</span><span style="color:#89DDFF;--shiki-dark:#F97583"> new</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> OperationResult</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#x3C;</span><span style="color:#FFCB6B;--shiki-dark:#B392F0">TResult</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">></span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">        &#123;</span></span>
<span class="line"><span style="color:#BABED8;--shiki-dark:#E1E4E8">            Success </span><span style="color:#89DDFF;--shiki-dark:#F97583">=</span><span style="color:#FF9CAC;--shiki-dark:#79B8FF"> true</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#BABED8;--shiki-dark:#E1E4E8">            Result </span><span style="color:#89DDFF;--shiki-dark:#F97583">=</span><span style="color:#BABED8;--shiki-dark:#E1E4E8"> result</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#BABED8;--shiki-dark:#E1E4E8">            Exception </span><span style="color:#89DDFF;--shiki-dark:#F97583">=</span><span style="color:#BABED8;--shiki-dark:#E1E4E8"> e</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">        &#125;;</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">    &#125;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;--shiki-dark:#F97583">    public</span><span style="color:#C792EA;--shiki-dark:#F97583"> static</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> OperationResult</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#x3C;</span><span style="color:#FFCB6B;--shiki-dark:#B392F0">TResult</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">></span><span style="color:#82AAFF;--shiki-dark:#B392F0"> CreateFailed</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#FFCB6B;--shiki-dark:#B392F0">TResult</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> result</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">,</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> Exception</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> e</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">    &#123;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;--shiki-dark:#F97583;--shiki-dark-font-style:inherit">        return</span><span style="color:#89DDFF;--shiki-dark:#F97583"> new</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> OperationResult</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#x3C;</span><span style="color:#FFCB6B;--shiki-dark:#B392F0">TResult</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">></span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">        &#123;</span></span>
<span class="line"><span style="color:#BABED8;--shiki-dark:#E1E4E8">            Success </span><span style="color:#89DDFF;--shiki-dark:#F97583">=</span><span style="color:#FF9CAC;--shiki-dark:#79B8FF"> false</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#BABED8;--shiki-dark:#E1E4E8">            Exception </span><span style="color:#89DDFF;--shiki-dark:#F97583">=</span><span style="color:#BABED8;--shiki-dark:#E1E4E8"> e</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">        &#125;;</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">    &#125;</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#125;</span></span></code></pre><!----> <!----><pre class="shiki shiki-themes material-theme-palenight github-dark" style="background-color:#292D3E;--shiki-dark-bg:#24292e;color:#babed8;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit">// Consumer of our service</span></span>
<span class="line"><span style="color:#C792EA;--shiki-dark:#F97583">public</span><span style="color:#FFCB6B;--shiki-dark:#F97583"> class</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> Consumer</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#123;</span></span>
<span class="line"><span style="color:#C792EA;--shiki-dark:#F97583">    public</span><span style="color:#C792EA;--shiki-dark:#F97583"> async</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> Task</span><span style="color:#82AAFF;--shiki-dark:#B392F0"> Run</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">()</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">    &#123;</span></span>
<span class="line"><span style="color:#FFCB6B;--shiki-dark:#F97583">        var</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> urls</span><span style="color:#89DDFF;--shiki-dark:#F97583"> =</span><span style="color:#89DDFF;--shiki-dark:#F97583"> new</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">[]</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">        &#123;</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#9ECBFF">            "</span><span style="color:#C3E88D;--shiki-dark:#9ECBFF">https://www.maltsev.space/sources/1</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">"</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#9ECBFF">            "</span><span style="color:#C3E88D;--shiki-dark:#9ECBFF">https://www.maltsev.space/sources/2</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">"</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#9ECBFF">            "</span><span style="color:#C3E88D;--shiki-dark:#9ECBFF">https://www.maltsev.space/sources/3</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">"</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">        &#125;;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;--shiki-dark:#F97583">        var</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> service</span><span style="color:#89DDFF;--shiki-dark:#F97583"> =</span><span style="color:#89DDFF;--shiki-dark:#F97583"> new</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> AggregationService</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;--shiki-dark:#F97583">        var</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> countResult</span><span style="color:#89DDFF;--shiki-dark:#F97583"> =</span><span style="color:#89DDFF;--shiki-dark:#F97583"> await</span><span style="color:#BABED8;--shiki-dark:#E1E4E8"> service</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">.</span><span style="color:#82AAFF;--shiki-dark:#B392F0">Count</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">urls</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">).</span><span style="color:#82AAFF;--shiki-dark:#B392F0">ConfigureAwait</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#FF9CAC;--shiki-dark:#79B8FF">false</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;--shiki-dark:#F97583;--shiki-dark-font-style:inherit">        if</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">countResult</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">.</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">IsTotallySuccessful</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#BABED8;--shiki-dark:#E1E4E8">            Trace</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">.</span><span style="color:#82AAFF;--shiki-dark:#B392F0">WriteLine</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">$"</span><span style="color:#C3E88D;--shiki-dark:#9ECBFF">Total count: </span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#123;</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">countResult</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">.</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">Result</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#125;"</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;--shiki-dark:#F97583;--shiki-dark-font-style:inherit">        else</span><span style="color:#89DDFF;font-style:italic;--shiki-dark:#F97583;--shiki-dark-font-style:inherit"> if</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8"> (</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">countResult</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">.</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">Success</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#BABED8;--shiki-dark:#E1E4E8">            Trace</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">.</span><span style="color:#82AAFF;--shiki-dark:#B392F0">WriteLine</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">$"</span><span style="color:#C3E88D;--shiki-dark:#9ECBFF">Count is around: </span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#123;</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">countResult</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">.</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">Result</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#125;</span><span style="color:#BABED8;--shiki-dark:#79B8FF">&#92;n</span><span style="color:#C3E88D;--shiki-dark:#9ECBFF">Error: </span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#123;</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">countResult</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">.</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">Exception</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#125;"</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;--shiki-dark:#F97583;--shiki-dark-font-style:inherit">        else</span></span>
<span class="line"><span style="color:#BABED8;--shiki-dark:#E1E4E8">            Trace</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">.</span><span style="color:#82AAFF;--shiki-dark:#B392F0">WriteLine</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">$"</span><span style="color:#C3E88D;--shiki-dark:#9ECBFF">Error: </span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#123;</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">countResult</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">.</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">Exception</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#125;"</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">    &#125;</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#125;</span></span></code></pre><!----> <p>The main idea is that it is grouping result and errors, so we have full information about result of the operation and may react as we want. In our case we want to show user any result, even if it isn’t full.</p> <p>So, as in the example with frequent word, our model of complex result just group everything together. It’s useful when we construct complex result via our factory-methods, but then in the consumer we need only its fields.</p> <p>There may be different ways of how we consume these results, for example, we just need requested data, even if it may be equals <code>default</code> (empty).</p> <p>So, we can use deconstruction and discards. Firstly, we create <code>Deconstruct</code> with all 4 fields:</p> <!----><pre class="shiki shiki-themes material-theme-palenight github-dark" style="background-color:#292D3E;--shiki-dark-bg:#24292e;color:#babed8;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#C792EA;--shiki-dark:#F97583">public</span><span style="color:#89DDFF;--shiki-dark:#F97583"> void</span><span style="color:#82AAFF;--shiki-dark:#B392F0"> Deconstruct</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#C792EA;--shiki-dark:#F97583">out</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> TResult</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> result</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">,</span><span style="color:#C792EA;--shiki-dark:#F97583"> out</span><span style="color:#89DDFF;--shiki-dark:#F97583"> bool</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> success</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">,</span><span style="color:#C792EA;--shiki-dark:#F97583"> out</span><span style="color:#89DDFF;--shiki-dark:#F97583"> bool</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> totalSuccess</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">,</span><span style="color:#C792EA;--shiki-dark:#F97583"> out</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> Exception</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> exception</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#123;</span></span>
<span class="line"><span style="color:#BABED8;--shiki-dark:#E1E4E8">    result </span><span style="color:#89DDFF;--shiki-dark:#F97583">=</span><span style="color:#BABED8;--shiki-dark:#E1E4E8"> Result</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#BABED8;--shiki-dark:#E1E4E8">    success </span><span style="color:#89DDFF;--shiki-dark:#F97583">=</span><span style="color:#BABED8;--shiki-dark:#E1E4E8"> Success</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#BABED8;--shiki-dark:#E1E4E8">    totalSuccess </span><span style="color:#89DDFF;--shiki-dark:#F97583">=</span><span style="color:#BABED8;--shiki-dark:#E1E4E8"> IsTotallySuccessful</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#BABED8;--shiki-dark:#E1E4E8">    exception </span><span style="color:#89DDFF;--shiki-dark:#F97583">=</span><span style="color:#BABED8;--shiki-dark:#E1E4E8"> Exception</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#89DDFF;--shiki-dark:#E1E4E8">&#125;</span></span></code></pre><!----> <p>Then we can deconstruct it as we want:</p> <!----><pre class="shiki shiki-themes material-theme-palenight github-dark" style="background-color:#292D3E;--shiki-dark-bg:#24292e;color:#babed8;--shiki-dark:#e1e4e8" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;--shiki-dark:#F97583">var</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8"> (</span><span style="color:#FFCB6B;--shiki-dark:#B392F0">count</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">,</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> _</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">,</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> totalSuccess</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">,</span><span style="color:#FFCB6B;--shiki-dark:#B392F0"> _</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span><span style="color:#89DDFF;--shiki-dark:#F97583"> =</span><span style="color:#89DDFF;--shiki-dark:#F97583"> await</span><span style="color:#BABED8;--shiki-dark:#E1E4E8"> service</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">.</span><span style="color:#82AAFF;--shiki-dark:#B392F0">Count</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">urls</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">).</span><span style="color:#82AAFF;--shiki-dark:#B392F0">ConfigureAwait</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#FF9CAC;--shiki-dark:#79B8FF">false</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;--shiki-dark:#F97583;--shiki-dark-font-style:inherit">if</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">totalSuccess</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#BABED8;--shiki-dark:#E1E4E8">    Trace</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">.</span><span style="color:#82AAFF;--shiki-dark:#B392F0">WriteLine</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">(</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">$"</span><span style="color:#C3E88D;--shiki-dark:#9ECBFF">Total count: </span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#123;</span><span style="color:#BABED8;--shiki-dark:#E1E4E8">count</span><span style="color:#89DDFF;--shiki-dark:#9ECBFF">&#125;"</span><span style="color:#89DDFF;--shiki-dark:#E1E4E8">);</span></span></code></pre><!----> <p>And that’s it, were are ready to go on!</p> <h2 id="further-reading"><a class="header-anchor" aria-hidden="true" tabindex="-1" href="#further-reading">#</a>Further reading</h2> <ul><li><a href="https://docs.microsoft.com/ru-ru/dotnet/csharp/deconstruct" rel="nofollow">Documentation about deconstruction</a></li> <li><a href="https://blogs.msdn.microsoft.com/seteplia/2017/11/01/dissecting-the-tuples-in-c-7/" rel="nofollow">Some investigation about how new tuples work</a></li> <li><a href="https://www.codeproject.com/Articles/1022462/Error-Handling-in-SOLID-Csharp-NET-The-Operation-R" rel="nofollow">Article about different kinds of error handling, like OperationResult</a></li></ul><!----></div> <footer class="post-footer svelte-17kp2kb"><div class="post-navigation svelte-17kp2kb"><!--[--><a href="/blog" class="button primary medium svelte-6ghmor"><!---->← Back to all posts<!----></a><!--]--><!----></div> <div class="card default svelte-10boycf"><div class="share-message svelte-17kp2kb">Enjoyed this post? Share it with the universe!</div> <div class="share-buttons svelte-17kp2kb"><a class="link default share-link twitter svelte-blzdii" target="_blank" rel="noopener noreferrer" href="https://twitter.com/intent/tweet?text=Benefits%20of%20deconstructors%20for%20custom%20types&amp;url=" aria-label="Share on Twitter"><!---->Twitter<!----> <!--[!--><!--]--></a><!----> <a class="link default share-link linkedin svelte-blzdii" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/shareArticle?mini=true&amp;title=Benefits%20of%20deconstructors%20for%20custom%20types&amp;url=" aria-label="Share on LinkedIn"><!---->LinkedIn<!----> <!--[!--><!--]--></a><!----> <a class="link default share-link facebook svelte-blzdii" target="_blank" rel="noopener noreferrer" href="https://www.facebook.com/sharer/sharer.php?u=" aria-label="Share on Facebook"><!---->Facebook<!----> <!--[!--><!--]--></a><!----></div><!----> <!--[!--><!--]--></div><!----></footer></article><!----><!----></div></main> <footer class="svelte-1mbgpkc"><div class="space-container"><p class="space-text-small">© 2025 | Aleksey Maltsev</p></div></footer><!----></div><!----><!--]--> <!--[!--><!--]--><!--]-->
			
			<script>
				{
					__sveltekit_1iqxhkq = {
						base: new URL("..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					Promise.all([
						import("../_app/immutable/entry/start.BTmCBczf.js"),
						import("../_app/immutable/entry/app.gU2dyjkM.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 5],
							data: [null,null],
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
